<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç®¡ç†å‘˜åå° - é—²ç‹—è”åˆä¼š</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon" type="image/svg+xml" href="img/jlp-logo.svg">
    <link rel="icon" type="image/png" href="img/jlp-logo.png">
    <style>
        /* æ¨¡æ€æ¡†æ ·å¼ */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            border: 1px solid #00ff88;
            border-radius: 15px;
            margin: 5% auto;
            padding: 0;
            width: 90%;
            max-width: 700px;
            box-shadow: 0 0 30px rgba(0, 255, 136, 0.3);
            animation: modalFadeIn 0.3s ease;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; transform: translateY(-50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .modal-header {
            background: rgba(0, 255, 136, 0.1);
            padding: 20px;
            border-bottom: 1px solid #00ff88;
            border-radius: 15px 15px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            margin: 0;
            color: #00ff88;
            font-size: 1.5rem;
        }

        .close {
            color: #00ff88;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            line-height: 1;
        }

        .close:hover {
            color: #ffffff;
        }

        .modal-body {
            padding: 20px;
        }

        .member-detail-info, .member-wallet-info {
            margin-bottom: 25px;
            padding: 15px;
            background: rgba(0, 255, 136, 0.05);
            border-radius: 10px;
            border: 1px solid rgba(0, 255, 136, 0.2);
        }

        .member-detail-info h4, .member-wallet-info h4 {
            color: #00ff88;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .wallet-actions {
            margin-top: 15px;
        }

        .transactions-list {
            max-height: 300px;
            overflow-y: auto;
            margin: 15px 0;
        }

        .transaction-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            margin: 5px 0;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            border-left: 4px solid #00ff88;
        }

        .transaction-item.withdraw {
            border-left-color: #ff4444;
        }

        .transaction-info {
            flex: 1;
        }

        .transaction-type {
            font-weight: bold;
            color: #00ff88;
        }

        .transaction-type.withdraw {
            color: #ff4444;
        }

        .transaction-date {
            font-size: 0.9rem;
            color: #888;
            margin-top: 5px;
        }

        .transaction-amount {
            font-weight: bold;
            font-size: 1.1rem;
        }

        .transaction-amount.deposit {
            color: #00ff88;
        }

        .transaction-amount.withdraw {
            color: #ff4444;
        }

        .member-transactions {
            margin-top: 20px;
            padding: 15px;
            background: rgba(0, 255, 136, 0.05);
            border-radius: 10px;
            border: 1px solid rgba(0, 255, 136, 0.2);
        }

        .wallet-balance {
            font-weight: bold;
            color: #00ff88;
        }
        
        /* è¡¨å•æ ·å¼ */
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #00ff88;
            font-weight: bold;
        }
        
        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid #00ff88;
            border-radius: 5px;
            background: rgba(0, 0, 0, 0.3);
            color: #ffffff;
            font-size: 1rem;
        }
        
        .form-control:focus {
            outline: none;
            border-color: #00cc6a;
            box-shadow: 0 0 10px rgba(0, 255, 136, 0.3);
        }
        
        .modal-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 20px;
        }

        /* ä¼šå‘˜åˆ—è¡¨æ ·å¼ */
        .member-list-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(0, 255, 136, 0.05);
            border-radius: 10px;
            border: 1px solid rgba(0, 255, 136, 0.2);
        }

        .member-list-header h3 {
            margin: 0;
            color: #00ff88;
        }

        .member-list-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .member-list-stats {
            display: flex;
            gap: 30px;
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            text-align: center;
        }

        .member-list-stats span {
            color: #ccc;
        }

        .member-list-stats strong {
            color: #00ff88;
            font-size: 1.2em;
        }

        .member-list-container {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .member-list-pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
        }

        .member-list-pagination button {
            padding: 8px 16px;
            font-size: 14px;
        }

        /* ä¼šå‘˜çŠ¶æ€æ ‡ç­¾ */
        .member-status {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }

        .member-status.active {
            background: #00ff88;
            color: #000;
        }

        .member-status.inactive {
            background: #666;
            color: #fff;
        }

        .member-status.suspended {
            background: #ff6b6b;
            color: #fff;
        }

        /* ä¼šå‘˜ç­‰çº§æ ‡ç­¾ */
        .member-level {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
            background: rgba(0, 255, 136, 0.2);
            color: #00ff88;
            border: 1px solid #00ff88;
        }

        /* ä¼šå‘˜èŒä½æ ‡ç­¾ */
        .member-position {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
            display: inline-block;
            min-width: 60px;
        }

        .position-å‰ä¸»å¸­ {
            background: rgba(255, 215, 0, 0.2);
            color: #FFD700;
            border: 1px solid #FFD700;
        }

        .position-ä¸»å¸­ {
            background: rgba(255, 107, 53, 0.2);
            color: #FF6B35;
            border: 1px solid #FF6B35;
        }

        .position-å‰¯ä¸»å¸­ {
            background: rgba(255, 142, 83, 0.2);
            color: #FF8E53;
            border: 1px solid #FF8E53;
        }

        .position-è´¢æ”¿ {
            background: rgba(0, 255, 136, 0.2);
            color: #00FF88;
            border: 1px solid #00FF88;
        }

        .position-å¤–äº¤ {
            background: rgba(135, 206, 235, 0.2);
            color: #87CEEB;
            border: 1px solid #87CEEB;
        }

        .position-è”è°Šä¼šè´·æ¬¾ {
            background: rgba(147, 112, 219, 0.2);
            color: #9370DB;
            border: 1px solid #9370DB;
        }

        .position-ç†äº‹ {
            background: rgba(70, 130, 180, 0.2);
            color: #4682B4;
            border: 1px solid #4682B4;
        }

        .position-å«ç”Ÿéƒ¨éƒ¨é•¿ {
            background: rgba(50, 205, 50, 0.2);
            color: #32CD32;
            border: 1px solid #32CD32;
        }

        .position-æ‰“æ‰‹ {
            background: rgba(220, 20, 60, 0.2);
            color: #DC143C;
            border: 1px solid #DC143C;
        }

        .position-è½¦æ‰‹ {
            background: rgba(255, 20, 147, 0.2);
            color: #FF1493;
            border: 1px solid #FF1493;
        }

        .position-æ™®é€šä¼šå‘˜ {
            background: rgba(204, 204, 204, 0.2);
            color: #CCCCCC;
            border: 1px solid #CCCCCC;
        }

        /* è¡¨æ ¼æ ·å¼å¢å¼º */
        .donations-table th {
            background: rgba(0, 255, 136, 0.1);
            color: #00ff88;
            font-weight: bold;
            padding: 12px;
            text-align: center;
        }

        .donations-table td {
            padding: 10px;
            text-align: center;
            border-bottom: 1px solid rgba(0, 255, 136, 0.1);
        }

        .donations-table tr:hover {
            background: rgba(0, 255, 136, 0.05);
        }

        /* æ“ä½œæŒ‰é’®æ ·å¼ */
        .member-action-btn {
            padding: 4px 8px;
            margin: 0 2px;
            font-size: 12px;
            border-radius: 4px;
        }

        .member-action-btn.view {
            background: #00ff88;
            color: #000;
        }

        .member-action-btn.edit {
            background: #ffc107;
            color: #000;
        }

        .member-action-btn.delete {
            background: #ff6b6b;
            color: #fff;
        }

        .member-action-btn.suspend {
            background: #666;
            color: #fff;
        }

        .member-action-btn.position {
            background: #ff6b35;
            color: #fff;
        }

        .member-action-btn.position:hover {
            background: #ff5722;
        }

        .member-action-btn.password {
            background: #9c27b0;
            color: #fff;
        }

        .member-action-btn.password:hover {
            background: #7b1fa2;
        }

        /* ä¼šè¯çŠ¶æ€æ ·å¼ */
        .session-status {
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid rgba(0, 255, 136, 0.3);
        }

        .session-status.warning {
            background: rgba(255, 193, 7, 0.1);
            border: 1px solid rgba(255, 193, 7, 0.3);
        }

        .session-status.danger {
            background: rgba(255, 68, 68, 0.1);
            border: 1px solid rgba(255, 68, 68, 0.3);
        }

        .session-status small {
            display: block;
            margin-top: 5px;
            font-size: 0.8rem;
            color: #888;
        }
    </style>
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="nav-container">
                <div class="nav-logo">
                    <img class="site-logo" src="img/jlp-logo.svg" onerror="this.src='img/jlp-logo.png'" alt="JLP Logo">
                    <h2 class="site-title">é—²ç‹—è”åˆä¼š - ç®¡ç†åå°</h2>
                </div>
                <ul class="nav-menu">
                    <li class="nav-item">
                        <a href="index.html" class="nav-link">è¿”å›é¦–é¡µ</a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" onclick="logout()">é€€å‡ºç™»å½•</a>
                    </li>
                </ul>
                <div class="hamburger">
                    <span class="bar"></span>
                    <span class="bar"></span>
                    <span class="bar"></span>
                </div>
            </div>
        </nav>
    </header>

    <main>
        <div class="page-header">
            <div class="container">
                <h1>ä¼šå‘˜ç®¡ç†åå°</h1>
                <p>å®¡æ ¸å’Œç®¡ç†ä¼šå‘˜æ³¨å†Œç”³è¯·</p>
            </div>
        </div>

        <section class="admin-section">
            <div class="container">
                <!-- ç®¡ç†å‘˜ç™»å½•è¡¨å• -->
                <div class="admin-login" id="adminLogin">
                    <div class="admin-login-container">
                        <form class="admin-login-form" id="adminLoginForm">
                            <h2>ç®¡ç†å‘˜ç™»å½•</h2>
                            
                            <div class="form-group">
                                <label for="adminUsername">ç®¡ç†å‘˜è´¦å·</label>
                                <input type="text" id="adminUsername" name="username" required 
                                       placeholder="è¯·è¾“å…¥ç®¡ç†å‘˜è´¦å·">
                                <span class="error-message" id="adminUsernameError"></span>
                            </div>

                            <div class="form-group">
                                <label for="adminPassword">ç®¡ç†å‘˜å¯†ç </label>
                                <input type="password" id="adminPassword" name="password" required 
                                       placeholder="è¯·è¾“å…¥ç®¡ç†å‘˜å¯†ç ">
                                <span class="error-message" id="adminPasswordError"></span>
                            </div>

                            <button type="submit" class="btn btn-primary btn-full">
                                ç™»å½•åå°
                            </button>
                        </form>
                    </div>
                </div>

                <!-- ç®¡ç†åå°ä¸»ç•Œé¢ -->
                <div class="admin-dashboard" id="adminDashboard" style="display: none;">
                    <div class="dashboard-header">
                        <h2>ä¼šå‘˜å®¡æ ¸ç®¡ç†</h2>
                        <div class="dashboard-stats">
                            <div class="stat-card">
                                <h3 id="pendingCount">0</h3>
                                <p>å¾…å®¡æ ¸</p>
                            </div>
                            <div class="stat-card">
                                <h3 id="approvedCount">0</h3>
                                <p>å·²é€šè¿‡</p>
                            </div>
                            <div class="stat-card">
                                <h3 id="rejectedCount">0</h3>
                                <p>å·²æ‹’ç»</p>
                            </div>
                            <div class="stat-card session-status">
                                <h3 id="sessionStatus">ğŸŸ¢</h3>
                                <p>ä¼šè¯çŠ¶æ€</p>
                                <small id="sessionTime">2:00:00</small>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-tabs">
                        <button class="tab-btn active" onclick="showTab('pending', this)">å¾…å®¡æ ¸ç”³è¯·</button>
                        <button class="tab-btn" onclick="showTab('memberList', this)">ä¼šå‘˜åˆ—è¡¨</button>
                        <button class="tab-btn" onclick="showTab('approved', this)">å·²é€šè¿‡ä¼šå‘˜</button>
                        <button class="tab-btn" onclick="showTab('rejected', this)">å·²æ‹’ç»ç”³è¯·</button>
                        <button class="tab-btn" onclick="showTab('donations', this)">ææ¬¾ç®¡ç†</button>
                        <button class="tab-btn" onclick="showTab('applications', this)">å…¥ä¼šç”³è¯·ç®¡ç†</button>
                        <button class="tab-btn" onclick="showTab('summary', this)">ä¼šå‘˜ææ¬¾æ±‡æ€»</button>
                    </div>

                    <!-- å¾…å®¡æ ¸ç”³è¯· -->
                    <div class="tab-content active" id="pendingTab">
                        <div class="applications-list" id="pendingApplications">
                            <!-- ç¤ºä¾‹å¾…å®¡æ ¸ç”³è¯· -->
                            <div class="application-card" data-id="1">
                                <div class="application-header">
                                    <h3>å¼ ä¸‰</h3>
                                    <span class="status-badge pending">å¾…å®¡æ ¸</span>
                                </div>
                                <div class="application-info">
                                    <div class="info-row">
                                        <span class="label">ç”¨æˆ·å:</span>
                                        <span class="value">zhangsan123</span>
                                    </div>
                                    <div class="info-row">
                                        <span class="label">é‚®ç®±:</span>
                                        <span class="value">zhangsan@example.com</span>
                                    </div>
                                    <div class="info-row">
                                        <span class="label">æ‰‹æœº:</span>
                                        <span class="value">138****5678</span>
                                    </div>
                                    <div class="info-row">
                                        <span class="label">åŸå¸‚:</span>
                                        <span class="value">åŒ—äº¬</span>
                                    </div>
                                    <div class="info-row">
                                        <span class="label">ç”³è¯·æ—¶é—´:</span>
                                        <span class="value">2024-01-15 14:30</span>
                                    </div>
                                </div>
                                <div class="application-details">
                                    <div class="detail-section">
                                        <h4>å…´è¶£çˆ±å¥½:</h4>
                                        <p>å–œæ¬¢æ‘„å½±ã€æ—…è¡Œã€ç¾é£Ÿï¼Œå¸Œæœ›èƒ½ç»“è¯†æ›´å¤šå¿—åŒé“åˆçš„æœ‹å‹ã€‚</p>
                                    </div>
                                    <div class="detail-section">
                                        <h4>ç”³è¯·ç†ç”±:</h4>
                                        <p>æˆ‘æ˜¯ä¸€ä¸ªçƒ­çˆ±ç”Ÿæ´»çš„äººï¼Œå¸Œæœ›é€šè¿‡é—²ç‹—è”åˆä¼šè®¤è¯†æ›´å¤šæœ‰è¶£çš„æœ‹å‹ï¼Œå‚ä¸å„ç§æœ‰æ„ä¹‰çš„æ´»åŠ¨ï¼Œä¸°å¯Œè‡ªå·±çš„ä¸šä½™ç”Ÿæ´»ã€‚æˆ‘ç›¸ä¿¡åœ¨è¿™ä¸ªå¹³å°ä¸Šèƒ½å¤Ÿæ‰¾åˆ°å±äºè‡ªå·±çš„åœˆå­ã€‚</p>
                                    </div>
                                </div>
                                <div class="application-actions">
                                    <button class="btn btn-success" onclick="approveApplication(1)">é€šè¿‡ç”³è¯·</button>
                                    <button class="btn btn-danger" onclick="rejectApplication(1)">æ‹’ç»ç”³è¯·</button>
                                    <button class="btn btn-secondary" onclick="viewDetails(1)">æŸ¥çœ‹è¯¦æƒ…</button>
                                </div>
                            </div>

                            <div class="application-card" data-id="2">
                                <div class="application-header">
                                    <h3>æå››</h3>
                                    <span class="status-badge pending">å¾…å®¡æ ¸</span>
                                </div>
                                <div class="application-info">
                                    <div class="info-row">
                                        <span class="label">ç”¨æˆ·å:</span>
                                        <span class="value">lisi456</span>
                                    </div>
                                    <div class="info-row">
                                        <span class="label">é‚®ç®±:</span>
                                        <span class="value">lisi@example.com</span>
                                    </div>
                                    <div class="info-row">
                                        <span class="label">æ‰‹æœº:</span>
                                        <span class="value">139****1234</span>
                                    </div>
                                    <div class="info-row">
                                        <span class="label">åŸå¸‚:</span>
                                        <span class="value">ä¸Šæµ·</span>
                                    </div>
                                    <div class="info-row">
                                        <span class="label">ç”³è¯·æ—¶é—´:</span>
                                        <span class="value">2024-01-16 09:15</span>
                                    </div>
                                </div>
                                <div class="application-details">
                                    <div class="detail-section">
                                        <h4>å…´è¶£çˆ±å¥½:</h4>
                                        <p>è¿åŠ¨å¥èº«ã€è¯»ä¹¦ã€ç”µå½±ï¼Œå–œæ¬¢æˆ·å¤–æ´»åŠ¨ã€‚</p>
                                    </div>
                                    <div class="detail-section">
                                        <h4>ç”³è¯·ç†ç”±:</h4>
                                        <p>ä½œä¸ºä¸€ä¸ªæ–°æ¥ä¸Šæµ·çš„äººï¼Œå¸Œæœ›èƒ½é€šè¿‡é—²ç‹—è”åˆä¼šå¿«é€Ÿèå…¥æœ¬åœ°ç”Ÿæ´»ï¼Œç»“è¯†æ–°æœ‹å‹ã€‚æˆ‘æ€§æ ¼å¼€æœ—ï¼Œä¹äºåŠ©äººï¼Œç›¸ä¿¡èƒ½ä¸ºç¤¾åŒºå¸¦æ¥æ­£èƒ½é‡ã€‚</p>
                                    </div>
                                </div>
                                <div class="application-actions">
                                    <button class="btn btn-success" onclick="approveApplication(2)">é€šè¿‡ç”³è¯·</button>
                                    <button class="btn btn-danger" onclick="rejectApplication(2)">æ‹’ç»ç”³è¯·</button>
                                    <button class="btn btn-secondary" onclick="viewDetails(2)">æŸ¥çœ‹è¯¦æƒ…</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ä¼šå‘˜åˆ—è¡¨ -->
                    <div class="tab-content" id="memberListTab">
                        <div class="member-list-header">
                            <h3>å…¨éƒ¨ä¼šå‘˜åˆ—è¡¨</h3>
                            <div class="member-list-actions">
                                <button class="btn btn-warning" onclick="showOneClickRegistrationModal()" style="background: #ff6b35; border-color: #ff6b35;">
                                    <i>âš¡</i> ä¸€é”®æ³¨å†Œä¼šå‘˜
                                </button>
                                <input type="text" id="memberSearchInput" placeholder="æœç´¢ä¼šå‘˜å§“åæˆ–é‚®ç®±..." class="form-control" style="width: 250px; display: inline-block;">
                                <select id="memberLevelFilter" class="form-control" style="width: 150px; display: inline-block;">
                                    <option value="">å…¨éƒ¨ç­‰çº§</option>
                                    <option value="1">1çº§</option>
                                    <option value="2">2çº§</option>
                                    <option value="3">3çº§</option>
                                    <option value="4">4çº§</option>
                                    <option value="5">5çº§</option>
                                </select>
                                <button class="btn btn-primary" onclick="searchMembers()">æœç´¢</button>
                                <button class="btn btn-secondary" onclick="resetMemberSearch()">é‡ç½®</button>
                                <button class="btn btn-success" onclick="exportMemberList()">å¯¼å‡ºåˆ—è¡¨</button>
                            </div>
                        </div>
                        <div class="member-list-stats">
                            <span>æ€»ä¼šå‘˜æ•°: <strong id="totalMemberCount">0</strong></span>
                            <span>åœ¨çº¿ä¼šå‘˜: <strong id="onlineMemberCount">0</strong></span>
                            <span>æ´»è·ƒä¼šå‘˜(30å¤©å†…): <strong id="activeMemberCount">0</strong></span>
                        </div>
                        <div class="member-list-container">
                            <table class="donations-table">
                                <thead>
                                    <tr>
                                        <th>ä¼šå‘˜ID</th>
                                        <th>ç”¨æˆ·å</th>
                                        <th>èŒä½</th>
                                        <th>é‚®ç®±</th>
                                        <th>æ‰‹æœº</th>
                                        <th>åŸå¸‚</th>
                                        <th>ä¼šå‘˜ç­‰çº§</th>
                                        <th>ç´¯è®¡ææ¬¾</th>
                                        <th>é’±åŒ…ä½™é¢</th>
                                        <th>æ³¨å†Œæ—¶é—´</th>
                                        <th>æœ€åæ´»è·ƒ</th>
                                        <th>çŠ¶æ€</th>
                                        <th>æ“ä½œ</th>
                                    </tr>
                                </thead>
                                <tbody id="memberListTableBody">
                                    <!-- ä¼šå‘˜åˆ—è¡¨å°†é€šè¿‡JSåŠ¨æ€åŠ è½½ -->
                                </tbody>
                            </table>
                            <div id="memberListLoading" style="text-align: center; padding: 20px;">
                                <p>æ­£åœ¨åŠ è½½ä¼šå‘˜åˆ—è¡¨...</p>
                            </div>
                            <div id="memberListEmpty" style="text-align: center; padding: 20px; display: none;">
                                <p>æš‚æ— ä¼šå‘˜æ•°æ®</p>
                            </div>
                        </div>
                        <div class="member-list-pagination" style="margin-top: 20px; text-align: center;">
                            <button class="btn btn-secondary" onclick="loadPreviousPage()" id="prevPageBtn">ä¸Šä¸€é¡µ</button>
                            <span style="margin: 0 15px;">ç¬¬ <span id="currentPage">1</span> é¡µ</span>
                            <button class="btn btn-secondary" onclick="loadNextPage()" id="nextPageBtn">ä¸‹ä¸€é¡µ</button>
                        </div>
                    </div>

                    <!-- å·²é€šè¿‡ä¼šå‘˜ -->
                    <div class="tab-content" id="approvedTab">
                        <div class="members-list" id="approvedMembers">
                            <div class="member-card">
                                <div class="member-header">
                                    <h3>ç‹äº”</h3>
                                    <span class="status-badge approved">å·²é€šè¿‡</span>
                                </div>
                                <div class="member-info">
                                    <div class="info-row">
                                        <span class="label">ç”¨æˆ·å:</span>
                                        <span class="value">wangwu789</span>
                                    </div>
                                    <div class="info-row">
                                        <span class="label">é‚®ç®±:</span>
                                        <span class="value">wangwu@example.com</span>
                                    </div>
                                    <div class="info-row">
                                        <span class="label">é’±åŒ…ä½™é¢:</span>
                                        <span class="value wallet-balance" data-member-id="wangwu789">Â¥0.00</span>
                                    </div>
                                    <div class="info-row">
                                        <span class="label">å®¡æ ¸æ—¶é—´:</span>
                                        <span class="value">2024-01-10 16:20</span>
                                    </div>
                                    <div class="info-row">
                                        <span class="label">æœ€åç™»å½•:</span>
                                        <span class="value">2024-01-16 10:30</span>
                                    </div>
                                </div>
                                <div class="member-actions">
                                    <button class="btn btn-warning" onclick="suspendMember('wangwu789')">æš‚åœè´¦æˆ·</button>
                                    <button class="btn btn-secondary" onclick="viewMemberDetails('wangwu789')">æŸ¥çœ‹è¯¦æƒ…</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- å·²æ‹’ç»ç”³è¯· -->
                    <div class="tab-content" id="rejectedTab">
                        <div class="rejected-list" id="rejectedApplications">
                            <div class="application-card">
                                <div class="application-header">
                                    <h3>èµµå…­</h3>
                                    <span class="status-badge rejected">å·²æ‹’ç»</span>
                                </div>
                                <div class="application-info">
                                    <div class="info-row">
                                        <span class="label">æ‹’ç»åŸå› :</span>
                                        <span class="value">ç”³è¯·ç†ç”±ä¸å……åˆ†</span>
                                    </div>
                                    <div class="info-row">
                                        <span class="label">æ‹’ç»æ—¶é—´:</span>
                                        <span class="value">2024-01-12 11:45</span>
                                    </div>
                                </div>
                                <div class="application-actions">
                                    <button class="btn btn-primary" onclick="reconsiderApplication('zhaoliu')">é‡æ–°è€ƒè™‘</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- ææ¬¾ç®¡ç† -->
                    <div class="tab-content" id="donationsTab" style="display: none;">
                        <div class="donations-list" id="donationsList">
                            <h3>ææ¬¾è®°å½•</h3>
                            <div class="donations-actions" style="margin: 10px 0; display: flex; gap: 8px; align-items: center;">
                                <button class="btn btn-secondary" id="exportDonationsBtn">å¯¼å‡ºææ¬¾è®°å½•</button>
                                <button class="btn btn-secondary" id="importDonationsBtn">å¯¼å…¥ææ¬¾è®°å½•</button>
                                <input type="file" id="donationsImportFile" accept="application/json" style="display:none" />
                                <span style="font-size: 12px; color: #666;">æç¤ºï¼šå½“å‰ä¸ºæœ¬åœ°æ¼”ç¤ºç‰ˆï¼Œè·¨æµè§ˆå™¨éœ€å¯¼å‡º/å¯¼å…¥æ•°æ®</span>
                            </div>
                            <table class="donations-table">
                                <thead>
                                    <tr>
                                        <th>ææ¬¾äººå§“å</th>
                                        <th>ç”µå­é‚®ç®±</th>
                                        <th>ææ¬¾é‡‘é¢ (å…ƒ)</th>
                                        <th>ææ¬¾æ—¥æœŸ</th>
                                    </tr>
                                </thead>
                                <tbody id="donationsTableBody">
                                    <!-- ææ¬¾è®°å½•å°†é€šè¿‡JSåŠ¨æ€æ’å…¥ -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- å…¥ä¼šç”³è¯·ç®¡ç† -->
                    <div class="tab-content" id="applicationsTab" style="display: none;">
                        <h3>ä¼šå‘˜ç”³è¯·è®°å½•</h3>
                        <table class="donations-table">
                            <thead>
                                <tr>
                                    <th>ç”³è¯·äººå§“å</th>
                                    <th>ç”µå­é‚®ç®±</th>
                                    <th>ä¼šå‘˜ç±»å‹</th>
                                    <th>å¹´è´¹ (å…ƒ)</th>
                                    <th>æ”¯ä»˜æ–¹å¼</th>
                                    <th>æäº¤æ—¶é—´</th>
                                    <th>çŠ¶æ€</th>
                                    <th>æ“ä½œ</th>
                                </tr>
                            </thead>
                            <tbody id="applicationsTableBody">
                                <!-- ç”³è¯·è®°å½•å°†é€šè¿‡JSåŠ¨æ€æ’å…¥ -->
                            </tbody>
                        </table>
                    </div>

                    <!-- ä¼šå‘˜ææ¬¾æ±‡æ€» -->
                    <div class="tab-content" id="summaryTab" style="display: none;">
                        <h3>ä¼šå‘˜åˆ—è¡¨ï¼ˆç­‰çº§ä¸ææ¬¾æ±‡æ€»ï¼‰</h3>
                        <table class="donations-table">
                            <thead>
                                <tr>
                                    <th>ä¼šå‘˜å§“å</th>
                                    <th>ç”µå­é‚®ç®±</th>
                                    <th>ä¼šå‘˜ç­‰çº§</th>
                                    <th>ç´¯è®¡ææ¬¾ï¼ˆå…ƒï¼‰</th>
                                    <th>åœ¨çº¿çŠ¶æ€</th>
                                    <th>æœ€åæ´»è·ƒ</th>
                                    <th>æ“ä½œ</th>
                                </tr>
                            </thead>
                            <tbody id="donationSummaryBody">
                                <!-- æ±‡æ€»æ•°æ®å°†é€šè¿‡JSåŠ¨æ€æ’å…¥ -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- ä¼šå‘˜è¯¦æƒ…æ¨¡æ€æ¡† -->
    <div id="memberDetailModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ä¼šå‘˜è¯¦ç»†ä¿¡æ¯</h3>
                <span class="close" onclick="closeMemberDetailModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="member-detail-info">
                    <h4>åŸºæœ¬ä¿¡æ¯</h4>
                    <div class="info-row">
                        <span class="label">ç”¨æˆ·å:</span>
                        <span class="value" id="detailUsername">-</span>
                    </div>
                    <div class="info-row">
                        <span class="label">é‚®ç®±:</span>
                        <span class="value" id="detailEmail">-</span>
                    </div>
                    <div class="info-row">
                        <span class="label">æ‰‹æœº:</span>
                        <span class="value" id="detailPhone">-</span>
                    </div>
                    <div class="info-row">
                        <span class="label">åŸå¸‚:</span>
                        <span class="value" id="detailCity">-</span>
                    </div>
                    <div class="info-row">
                        <span class="label">æ³¨å†Œæ—¶é—´:</span>
                        <span class="value" id="detailJoinedAt">-</span>
                    </div>
                </div>
                
                <div class="member-wallet-info">
                    <h4>é’±åŒ…ä¿¡æ¯</h4>
                    <div class="info-row">
                        <span class="label">å½“å‰ä½™é¢:</span>
                        <span class="value" id="detailWalletBalance">Â¥0.00</span>
                    </div>
                    <div class="wallet-actions">
                        <button class="btn btn-primary" onclick="showWalletTransactions()">æŸ¥çœ‹äº¤æ˜“è®°å½•</button>
                    </div>
                </div>
                
                <div class="member-transactions" id="memberTransactions" style="display: none;">
                    <h4>äº¤æ˜“è®°å½•</h4>
                    <div class="transactions-list" id="transactionsList">
                        <!-- äº¤æ˜“è®°å½•å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                    </div>
                    <button class="btn btn-secondary" onclick="hideWalletTransactions()">éšè—äº¤æ˜“è®°å½•</button>
                </div>
            </div>
        </div>
    </div>

    <!-- é‡ç½®å¯†ç æ¨¡æ€æ¡† -->
    <div id="resetPasswordModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>é‡ç½®ä¼šå‘˜å¯†ç </h3>
                <span class="close" onclick="closeResetPasswordModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="newPasswordInput">æ–°å¯†ç ï¼š</label>
                    <input type="password" id="newPasswordInput" class="form-control" placeholder="è¯·è¾“å…¥æ–°å¯†ç ">
                </div>
                <div class="form-group">
                    <label for="confirmPasswordInput">ç¡®è®¤å¯†ç ï¼š</label>
                    <input type="password" id="confirmPasswordInput" class="form-control" placeholder="è¯·å†æ¬¡è¾“å…¥æ–°å¯†ç ">
                </div>
                <div class="modal-actions">
                    <button class="btn btn-primary" onclick="confirmResetPassword()">ç¡®è®¤é‡ç½®</button>
                    <button class="btn btn-secondary" onclick="closeResetPasswordModal()">å–æ¶ˆ</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ç¼–è¾‘ä¼šå‘˜ä¿¡æ¯æ¨¡æ€æ¡† -->
    <div id="editMemberModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ç¼–è¾‘ä¼šå‘˜ä¿¡æ¯</h3>
                <span class="close" onclick="closeEditMemberModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="editMemberUsername">ç”¨æˆ·åï¼š</label>
                    <input type="text" id="editMemberUsername" class="form-control" placeholder="è¯·è¾“å…¥ç”¨æˆ·å">
                </div>
                <div class="form-group">
                    <label for="editMemberEmail">é‚®ç®±ï¼š</label>
                    <input type="email" id="editMemberEmail" class="form-control" placeholder="è¯·è¾“å…¥é‚®ç®±">
                </div>
                <div class="form-group">
                    <label for="editMemberPhone">æ‰‹æœºï¼š</label>
                    <input type="tel" id="editMemberPhone" class="form-control" placeholder="è¯·è¾“å…¥æ‰‹æœºå·ç ">
                </div>
                <div class="form-group">
                    <label for="editMemberCity">åŸå¸‚ï¼š</label>
                    <input type="text" id="editMemberCity" class="form-control" placeholder="è¯·è¾“å…¥åŸå¸‚">
                </div>
                <div class="modal-actions">
                    <button class="btn btn-primary" onclick="confirmEditMember()">ä¿å­˜ä¿®æ”¹</button>
                    <button class="btn btn-secondary" onclick="closeEditMemberModal()">å–æ¶ˆ</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ä¿®æ”¹å¯†ç æ¨¡æ€æ¡† -->
    <div id="changePasswordModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ä¿®æ”¹ä¼šå‘˜å¯†ç </h3>
                <span class="close" onclick="closeChangePasswordModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="changePasswordMemberName">ä¼šå‘˜åç§°ï¼š</label>
                    <input type="text" id="changePasswordMemberName" class="form-control" readonly>
                </div>
                <div class="form-group">
                    <label for="newPassword">æ–°å¯†ç ï¼š</label>
                    <input type="password" id="newPassword" class="form-control" placeholder="è¯·è¾“å…¥æ–°å¯†ç ">
                </div>
                <div class="form-group">
                    <label for="confirmNewPassword">ç¡®è®¤æ–°å¯†ç ï¼š</label>
                    <input type="password" id="confirmNewPassword" class="form-control" placeholder="è¯·å†æ¬¡è¾“å…¥æ–°å¯†ç ">
                </div>
                <div class="modal-actions">
                    <button class="btn btn-primary" onclick="confirmChangePassword()">ç¡®è®¤ä¿®æ”¹</button>
                    <button class="btn btn-secondary" onclick="closeChangePasswordModal()">å–æ¶ˆ</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ç¡®è®¤å¯¹è¯æ¡†æ¨¡æ€æ¡† -->
    <div id="confirmModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="confirmModalTitle">ç¡®è®¤æ“ä½œ</h3>
                <span class="close" onclick="closeConfirmModal()">&times;</span>
            </div>
            <div class="modal-body">
                <p id="confirmModalMessage">ç¡®å®šè¦æ‰§è¡Œæ­¤æ“ä½œå—ï¼Ÿ</p>
                <div class="modal-actions">
                    <button class="btn btn-primary" id="confirmModalOk">ç¡®å®š</button>
                    <button class="btn btn-secondary" onclick="closeConfirmModal()">å–æ¶ˆ</button>
                </div>
            </div>
        </div>
    </div>

    <!-- æ¶ˆæ¯æç¤ºæ¨¡æ€æ¡† -->
    <div id="messageModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="messageModalTitle">æç¤º</h3>
                <span class="close" onclick="closeMessageModal()">&times;</span>
            </div>
            <div class="modal-body">
                <p id="messageModalMessage">æ“ä½œå®Œæˆ</p>
                <div class="modal-actions">
                    <button class="btn btn-primary" onclick="closeMessageModal()">ç¡®å®š</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ä¸€é”®æ³¨å†Œä¼šå‘˜æ¨¡æ€æ¡† -->
    <div id="oneClickRegistrationModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ä¸€é”®æ³¨å†Œä¼šå‘˜</h3>
                <span class="close" onclick="closeOneClickRegistrationModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="registrationCount">æ³¨å†Œæ•°é‡ï¼š</label>
                    <input type="number" id="registrationCount" class="form-control" value="1" min="1" max="10" placeholder="è¯·è¾“å…¥æ³¨å†Œæ•°é‡(1-10)">
                    <small style="color: #ccc;">ä¸€æ¬¡æœ€å¤šå¯æ³¨å†Œ10ä¸ªä¼šå‘˜è´¦å·</small>
                </div>
                <div class="form-group">
                    <label for="memberLevelSelect">é»˜è®¤ä¼šå‘˜ç­‰çº§ï¼š</label>
                    <select id="memberLevelSelect" class="form-control">
                        <option value="1">1çº§ - æ™®é€šä¼šå‘˜</option>
                        <option value="2">2çº§ - é“¶ç‰Œä¼šå‘˜</option>
                        <option value="3">3çº§ - é‡‘ç‰Œä¼šå‘˜</option>
                        <option value="4">4çº§ - é“‚é‡‘ä¼šå‘˜</option>
                        <option value="5">5çº§ - é’»çŸ³ä¼šå‘˜</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="autoPassword">è‡ªåŠ¨ç”Ÿæˆå¯†ç ï¼š</label>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <input type="text" id="autoPassword" class="form-control" readonly placeholder="ç‚¹å‡»ç”Ÿæˆå¯†ç ">
                        <button type="button" class="btn btn-secondary" onclick="generateRandomPassword()">ç”Ÿæˆ</button>
                    </div>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="autoActivate" checked> è‡ªåŠ¨æ¿€æ´»è´¦å·
                    </label>
                </div>
                <div class="modal-actions">
                    <button class="btn btn-primary" onclick="confirmOneClickRegistration()">å¼€å§‹æ³¨å†Œ</button>
                    <button class="btn btn-secondary" onclick="closeOneClickRegistrationModal()">å–æ¶ˆ</button>
                </div>
            </div>
        </div>
    </div>

    <!-- è®¾ç½®èŒä½æ¨¡æ€æ¡† -->
    <div id="setPositionModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>è®¾ç½®ä¼šå‘˜èŒä½</h3>
                <span class="close" onclick="closeSetPositionModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="memberPositionSelect">é€‰æ‹©èŒä½ï¼š</label>
                    <select id="memberPositionSelect" class="form-control">
                        <option value="">æ™®é€šä¼šå‘˜</option>
                        <option value="å‰ä¸»å¸­">ğŸ›ï¸ å‰ä¸»å¸­</option>
                        <option value="ä¸»å¸­">ğŸ‘‘ ä¸»å¸­</option>
                        <option value="å‰¯ä¸»å¸­">ğŸ‘‘ å‰¯ä¸»å¸­</option>
                        <option value="è´¢æ”¿">ğŸ’° è´¢æ”¿</option>
                        <option value="å¤–äº¤">ğŸ¤ å¤–äº¤</option>
                        <option value="è”è°Šä¼šè´·æ¬¾">ğŸ’³ è”è°Šä¼šè´·æ¬¾</option>
                        <option value="ç†äº‹">ğŸ“‹ ç†äº‹</option>
                        <option value="å«ç”Ÿéƒ¨éƒ¨é•¿">ğŸ§¹ å«ç”Ÿéƒ¨éƒ¨é•¿</option>
                        <option value="æ‰“æ‰‹">ğŸ’ª æ‰“æ‰‹</option>
                        <option value="è½¦æ‰‹">ğŸï¸ è½¦æ‰‹</option>
                        <option value="è‡ªå®šä¹‰">âœï¸ è‡ªå®šä¹‰èŒä½</option>
                    </select>
                </div>
                <div class="form-group" id="customPositionGroup" style="display: none;">
                    <label for="customPositionInput">è‡ªå®šä¹‰èŒä½åç§°ï¼š</label>
                    <input type="text" id="customPositionInput" class="form-control" placeholder="è¯·è¾“å…¥è‡ªå®šä¹‰èŒä½åç§°">
                </div>
                <div class="form-group">
                    <label for="positionStartDate">ä»»èŒå¼€å§‹æ—¥æœŸï¼š</label>
                    <input type="date" id="positionStartDate" class="form-control">
                </div>
                <div class="form-group">
                    <label for="positionEndDate">ä»»èŒç»“æŸæ—¥æœŸï¼š</label>
                    <input type="date" id="positionEndDate" class="form-control">
                    <small style="color: #ccc;">ç•™ç©ºè¡¨ç¤ºé•¿æœŸä»»èŒ</small>
                </div>
                <div class="form-group">
                    <label for="positionNotes">å¤‡æ³¨ï¼š</label>
                    <textarea id="positionNotes" class="form-control" rows="3" placeholder="èŒä½ç›¸å…³å¤‡æ³¨ä¿¡æ¯"></textarea>
                </div>
                <div class="modal-actions">
                    <button class="btn btn-primary" onclick="confirmSetPosition()">ç¡®è®¤è®¾ç½®</button>
                    <button class="btn btn-secondary" onclick="closeSetPositionModal()">å–æ¶ˆ</button>
                </div>
            </div>
        </div>
    </div>

    <!-- æ³¨å†Œç»“æœæ¨¡æ€æ¡† -->
    <div id="registrationResultModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>æ³¨å†Œç»“æœ</h3>
                <span class="close" onclick="closeRegistrationResultModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div id="registrationResults" style="max-height: 400px; overflow-y: auto;">
                    <!-- æ³¨å†Œç»“æœå°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                </div>
                <div class="modal-actions">
                    <button class="btn btn-primary" onclick="closeRegistrationResultModal()">ç¡®å®š</button>
                    <button class="btn btn-success" onclick="exportRegistrationResults()">å¯¼å‡ºç»“æœ</button>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>é—²ç‹—è”åˆä¼š</h3>
                    <p>è¿æ¥å¿—åŒé“åˆçš„æœ‹å‹ï¼Œåˆ›é€ ç¾å¥½çš„å›å¿†</p>
                </div>
                <div class="footer-section">
                    <h4>ç®¡ç†åŠŸèƒ½</h4>
                    <ul>
                        <li><a href="#" onclick="showTab('pending')">ä¼šå‘˜å®¡æ ¸</a></li>
                        <li><a href="#" onclick="showTab('approved')">ä¼šå‘˜ç®¡ç†</a></li>
                        <li><a href="events.html">æ´»åŠ¨ç®¡ç†</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>è”ç³»æ–¹å¼</h4>
                    <p>ç®¡ç†å‘˜é‚®ç®±: <a href="mailto:admin@xiangou9360.com">admin@xiangou9360.com</a></p>
                    <p>æŠ€æœ¯æ”¯æŒ: 017-512-0686</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 é—²ç‹—è”åˆä¼š. ä¿ç•™æ‰€æœ‰æƒåˆ©.</p>
            </div>
        </div>
    </footer>

    <script src="js/api-client.js?v=5"></script>
    <script src="js/script.js?v=4"></script>
    <script>
        // ç®¡ç†å‘˜è®¤è¯åŠŸèƒ½
        let currentAdmin = null;
        let adminSessionTimeout = null;
        let adminActivityMonitor = null;
        let sessionTimerInterval = null;
        const ADMIN_SESSION_DURATION = 2 * 60 * 60 * 1000; // 2å°æ—¶
        const ADMIN_WARNING_TIME = 1.5 * 60 * 60 * 1000; // 1.5å°æ—¶æé†’
        const ADMIN_ACTIVITY_CHECK = 5 * 60 * 1000; // 5åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡æ´»åŠ¨çŠ¶æ€

        // æ£€æŸ¥ç®¡ç†å‘˜ç™»å½•çŠ¶æ€
        function checkAdminAuth() {
            const savedAdmin = localStorage.getItem('currentAdmin');
            const sessionExpiry = localStorage.getItem('adminSessionExpiry');
            
            if (savedAdmin && sessionExpiry) {
                const now = new Date().getTime();
                const expiry = parseInt(sessionExpiry);
                
                if (now < expiry) {
                    currentAdmin = JSON.parse(savedAdmin);
                    showAdminDashboard();
                    resetAdminSessionTimeout();
                    startActivityMonitoring();
                    return true;
                } else {
                    // ä¼šè¯è¿‡æœŸï¼Œæ¸…é™¤æ•°æ®
                    logoutAdmin();
                    return false;
                }
            }
            return false;
        }

        // å¼€å§‹æ´»åŠ¨ç›‘æ§
        function startActivityMonitoring() {
            // ç›‘å¬ç”¨æˆ·æ´»åŠ¨
            document.addEventListener('click', extendAdminSession);
            document.addEventListener('keypress', extendAdminSession);
            document.addEventListener('scroll', extendAdminSession);
            
            // å®šæœŸæ£€æŸ¥ä¼šè¯çŠ¶æ€
            if (adminActivityMonitor) {
                clearInterval(adminActivityMonitor);
            }
            
            adminActivityMonitor = setInterval(() => {
                checkAdminSessionStatus();
            }, ADMIN_ACTIVITY_CHECK);
            
            // å¯åŠ¨ä¼šè¯è®¡æ—¶å™¨
            startSessionTimer();
        }

        // åœæ­¢æ´»åŠ¨ç›‘æ§
        function stopActivityMonitoring() {
            document.removeEventListener('click', extendAdminSession);
            document.removeEventListener('keypress', extendAdminSession);
            document.removeEventListener('scroll', extendAdminSession);
            
            if (adminActivityMonitor) {
                clearInterval(adminActivityMonitor);
                adminActivityMonitor = null;
            }
            
            // åœæ­¢ä¼šè¯è®¡æ—¶å™¨
            if (sessionTimerInterval) {
                clearInterval(sessionTimerInterval);
                sessionTimerInterval = null;
            }
        }

        // å¯åŠ¨ä¼šè¯è®¡æ—¶å™¨
        function startSessionTimer() {
            if (sessionTimerInterval) {
                clearInterval(sessionTimerInterval);
            }
            
            sessionTimerInterval = setInterval(() => {
                updateSessionTimer();
            }, 1000); // æ¯ç§’æ›´æ–°ä¸€æ¬¡
        }

        // æ›´æ–°ä¼šè¯è®¡æ—¶å™¨æ˜¾ç¤º
        function updateSessionTimer() {
            const sessionExpiry = localStorage.getItem('adminSessionExpiry');
            if (!sessionExpiry) return;
            
            const now = new Date().getTime();
            const expiry = parseInt(sessionExpiry);
            const timeRemaining = expiry - now;
            
            if (timeRemaining <= 0) {
                // ä¼šè¯å·²è¿‡æœŸ
                document.getElementById('sessionStatus').textContent = 'ğŸ”´';
                document.getElementById('sessionTime').textContent = 'å·²è¿‡æœŸ';
                document.querySelector('.session-status').classList.add('danger');
                document.querySelector('.session-status').classList.remove('warning');
                return;
            }
            
            // æ ¼å¼åŒ–å‰©ä½™æ—¶é—´
            const hours = Math.floor(timeRemaining / (1000 * 60 * 60));
            const minutes = Math.floor((timeRemaining % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((timeRemaining % (1000 * 60)) / 1000);
            
            const timeString = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            document.getElementById('sessionTime').textContent = timeString;
            
            // æ›´æ–°çŠ¶æ€æŒ‡ç¤ºå™¨
            if (timeRemaining <= 30 * 60 * 1000) {
                // å°‘äº30åˆ†é’Ÿæ˜¾ç¤ºè­¦å‘Š
                document.getElementById('sessionStatus').textContent = 'ğŸŸ¡';
                document.querySelector('.session-status').classList.add('warning');
                document.querySelector('.session-status').classList.remove('danger');
            } else if (timeRemaining <= 10 * 60 * 1000) {
                // å°‘äº10åˆ†é’Ÿæ˜¾ç¤ºå±é™©
                document.getElementById('sessionStatus').textContent = 'ğŸ”´';
                document.querySelector('.session-status').classList.add('danger');
                document.querySelector('.session-status').classList.remove('warning');
            } else {
                // æ­£å¸¸çŠ¶æ€
                document.getElementById('sessionStatus').textContent = 'ğŸŸ¢';
                document.querySelector('.session-status').classList.remove('warning', 'danger');
            }
        }

        // æ£€æŸ¥ç®¡ç†å‘˜ä¼šè¯çŠ¶æ€
        function checkAdminSessionStatus() {
            const sessionExpiry = localStorage.getItem('adminSessionExpiry');
            if (!sessionExpiry) {
                logoutAdmin();
                return;
            }
            
            const now = new Date().getTime();
            const expiry = parseInt(sessionExpiry);
            const timeRemaining = expiry - now;
            
            if (timeRemaining <= 0) {
                // ä¼šè¯å·²è¿‡æœŸ
                logoutAdmin();
            } else if (timeRemaining <= 10 * 60 * 1000) {
                // å°‘äº10åˆ†é’Ÿï¼Œè‡ªåŠ¨å»¶é•¿ä¼šè¯
                extendAdminSession();
            }
            
            // å®šæœŸéªŒè¯æœåŠ¡å™¨ç«¯ä¼šè¯ï¼ˆæ¯30åˆ†é’Ÿï¼‰
            if (currentAdmin && currentAdmin.sessionToken && Math.random() < 0.1) {
                validateServerAdminSession();
            }
        }

        // éªŒè¯æœåŠ¡å™¨ç«¯ç®¡ç†å‘˜ä¼šè¯
        async function validateServerAdminSession() {
            if (!currentAdmin || !currentAdmin.sessionToken) return;
            
            try {
                const result = await apiClient.validateAdminSession(currentAdmin.sessionToken);
                if (!result.success) {
                    console.warn('æœåŠ¡å™¨ç«¯ä¼šè¯éªŒè¯å¤±è´¥:', result.message);
                    // å¦‚æœæœåŠ¡å™¨ç«¯ä¼šè¯å·²è¿‡æœŸï¼Œæ‰§è¡Œæœ¬åœ°ç™»å‡º
                    if (result.message.includes('è¿‡æœŸ') || result.message.includes('æ— æ•ˆ')) {
                        logoutAdmin();
                    }
                }
            } catch (error) {
                console.error('éªŒè¯æœåŠ¡å™¨ç«¯ä¼šè¯å¤±è´¥:', error);
                // ç½‘ç»œé”™è¯¯æ—¶ä¸æ‰§è¡Œç™»å‡ºï¼Œä¿æŒæœ¬åœ°ä¼šè¯
            }
        }

        // å»¶é•¿ç®¡ç†å‘˜ä¼šè¯
        function extendAdminSession() {
            const sessionExpiry = localStorage.getItem('adminSessionExpiry');
            if (!sessionExpiry) return;
            
            const now = new Date().getTime();
            const expiry = parseInt(sessionExpiry);
            const timeRemaining = expiry - now;
            
            // å¦‚æœå‰©ä½™æ—¶é—´å°‘äº30åˆ†é’Ÿï¼Œå»¶é•¿ä¼šè¯
            if (timeRemaining < 30 * 60 * 1000) {
                const newExpiry = now + ADMIN_SESSION_DURATION;
                localStorage.setItem('adminSessionExpiry', newExpiry.toString());
                
                // é‡ç½®è¶…æ—¶æé†’
                resetAdminSessionTimeout();
                
                console.log('ç®¡ç†å‘˜ä¼šè¯å·²è‡ªåŠ¨å»¶é•¿');
            }
        }

        // ç®¡ç†å‘˜ç™»å½•
        async function loginAdmin(event) {
            event.preventDefault();
            
            const username = document.getElementById('adminUsername').value.trim();
            const password = document.getElementById('adminPassword').value.trim();
            
            if (!username || !password) {
                showMessageDialog('æç¤º', 'è¯·è¾“å…¥ç®¡ç†å‘˜è´¦å·å’Œå¯†ç ');
                return;
            }
            
            try {
                // ä½¿ç”¨æœåŠ¡å™¨ç«¯ç®¡ç†å‘˜ç™»å½•API
                const result = await apiClient.adminLogin(username, password);
                
                if (result.success) {
                    currentAdmin = {
                        username: username,
                        role: 'admin',
                        loginTime: new Date().toISOString(),
                        sessionToken: result.token // ä½¿ç”¨æœåŠ¡å™¨è¿”å›çš„ä»¤ç‰Œ
                    };
                    
                    // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
                    localStorage.setItem('currentAdmin', JSON.stringify(currentAdmin));
                    
                    // è®¾ç½®ä¼šè¯è¿‡æœŸæ—¶é—´ï¼ˆ2å°æ—¶ï¼‰
                    const expiry = new Date().getTime() + ADMIN_SESSION_DURATION;
                    localStorage.setItem('adminSessionExpiry', expiry.toString());
                    
                    // æ˜¾ç¤ºç®¡ç†é¢æ¿
                    showAdminDashboard();
                    resetAdminSessionTimeout();
                    startActivityMonitoring();
                    
                    // æ¸…ç©ºè¡¨å•
                    document.getElementById('adminLoginForm').reset();
                    
                    showMessageDialog('æç¤º', 'ç®¡ç†å‘˜ç™»å½•æˆåŠŸï¼');
                    
                    console.log('ç®¡ç†å‘˜ä¼šè¯å·²å¯åŠ¨ï¼Œå°†åœ¨2å°æ—¶åè¿‡æœŸ');
                } else {
                    showMessageDialog('æç¤º', result.message || 'ç®¡ç†å‘˜è´¦å·æˆ–å¯†ç é”™è¯¯ï¼');
                }
            } catch (error) {
                console.error('ç®¡ç†å‘˜ç™»å½•å¤±è´¥:', error);
                showMessageDialog('æç¤º', 'ç™»å½•å¤±è´¥ï¼Œè¯·é‡è¯•');
            }
        }

        // æ˜¾ç¤ºç®¡ç†å‘˜é¢æ¿
        function showAdminDashboard() {
            document.getElementById('adminLogin').style.display = 'none';
            document.getElementById('adminDashboard').style.display = 'block';
            
            // åŠ è½½åˆå§‹æ•°æ®
            loadDashboardData();
        }

        // æ˜¾ç¤ºç™»å½•ç•Œé¢
        function showAdminLogin() {
            document.getElementById('adminLogin').style.display = 'block';
            document.getElementById('adminDashboard').style.display = 'none';
        }

        // é‡ç½®ç®¡ç†å‘˜ä¼šè¯è¶…æ—¶
        function resetAdminSessionTimeout() {
            // æ¸…é™¤ä¹‹å‰çš„è¶…æ—¶
            if (adminSessionTimeout) {
                clearTimeout(adminSessionTimeout);
            }
            
            // è®¾ç½®æ–°çš„è¶…æ—¶ï¼ˆ1.5å°æ—¶åæé†’ï¼‰
            adminSessionTimeout = setTimeout(() => {
                showConfirmDialog('ä¼šè¯å³å°†è¿‡æœŸ', 'ç®¡ç†å‘˜ä¼šè¯å³å°†è¿‡æœŸï¼ˆ30åˆ†é’Ÿåï¼‰ï¼Œæ˜¯å¦ç»§ç»­ä¿æŒç™»å½•ï¼Ÿ', () => {
                    // ç”¨æˆ·é€‰æ‹©ä¿æŒç™»å½•ï¼Œå»¶é•¿ä¼šè¯
                    const newExpiry = new Date().getTime() + ADMIN_SESSION_DURATION;
                    localStorage.setItem('adminSessionExpiry', newExpiry.toString());
                    resetAdminSessionTimeout();
                    console.log('ç®¡ç†å‘˜ä¼šè¯å·²æ‰‹åŠ¨å»¶é•¿');
                }, () => {
                    // ç”¨æˆ·é€‰æ‹©é€€å‡º
                    logoutAdmin();
                });
            }, ADMIN_WARNING_TIME); // 1.5å°æ—¶
        }

        // ç®¡ç†å‘˜é€€å‡ºç™»å½•
        async function logoutAdmin() {
            // åœæ­¢æ´»åŠ¨ç›‘æ§
            stopActivityMonitoring();
            
            try {
                // å¦‚æœæœ‰ä¼šè¯ä»¤ç‰Œï¼Œè°ƒç”¨æœåŠ¡å™¨ç«¯é€€å‡º
                if (currentAdmin && currentAdmin.sessionToken) {
                    await apiClient.adminLogout(currentAdmin.sessionToken);
                }
            } catch (error) {
                console.error('æœåŠ¡å™¨ç«¯é€€å‡ºç™»å½•å¤±è´¥:', error);
                // å³ä½¿æœåŠ¡å™¨ç«¯é€€å‡ºå¤±è´¥ï¼Œä¹Ÿè¦ç»§ç»­æœ¬åœ°æ¸…ç†
            }
            
            // æ¸…é™¤æœ¬åœ°å­˜å‚¨çš„ç®¡ç†å‘˜æ•°æ®
            localStorage.removeItem('currentAdmin');
            localStorage.removeItem('adminSessionExpiry');
            
            // æ¸…é™¤ä¼šè¯è¶…æ—¶
            if (adminSessionTimeout) {
                clearTimeout(adminSessionTimeout);
                adminSessionTimeout = null;
            }
            
            currentAdmin = null;
            
            // æ˜¾ç¤ºç™»å½•ç•Œé¢
            showAdminLogin();
            
            showMessageDialog('æç¤º', 'ç®¡ç†å‘˜å·²é€€å‡ºç™»å½•');
            console.log('ç®¡ç†å‘˜ä¼šè¯å·²ç»“æŸ');
        }

        // åŠ è½½ä»ªè¡¨æ¿æ•°æ®
        function loadDashboardData() {
            // è¿™é‡Œå¯ä»¥åŠ è½½å„ç§ç»Ÿè®¡æ•°æ®
            console.log('åŠ è½½ç®¡ç†ä»ªè¡¨æ¿æ•°æ®...');
        }

        // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥ç®¡ç†å‘˜ç™»å½•çŠ¶æ€
        document.addEventListener('DOMContentLoaded', function() {
            // æ£€æŸ¥æ˜¯å¦å·²ç»ç™»å½•
            if (!checkAdminAuth()) {
                showAdminLogin();
            }
            
            // ç»‘å®šç™»å½•è¡¨å•æäº¤äº‹ä»¶
            document.getElementById('adminLoginForm').addEventListener('submit', loginAdmin);
        });

        // åå°é’±åŒ…ç®¡ç†åŠŸèƒ½
        let currentMemberId = null;
        let currentMemberForPosition = null;
        let currentMemberForPassword = null;

        // åŠ è½½ä¼šå‘˜é’±åŒ…ä½™é¢
        async function loadMemberWalletBalances() {
            const walletElements = document.querySelectorAll('.wallet-balance');
            for (const element of walletElements) {
                const memberId = element.getAttribute('data-member-id');
                if (memberId) {
                    try {
                        const result = await apiClient.getWallet(memberId);
                        if (result.success) {
                            element.textContent = `Â¥${result.wallet.balance.toFixed(2)}`;
                        }
                    } catch (error) {
                        console.error(`åŠ è½½ä¼šå‘˜ ${memberId} é’±åŒ…ä½™é¢å¤±è´¥:`, error);
                        element.textContent = 'Â¥0.00';
                    }
                }
            }
        }

        // æŸ¥çœ‹ä¼šå‘˜è¯¦æƒ…
        async function viewMemberDetails(memberId) {
            currentMemberId = memberId;
            try {
                // è·å–ä¼šå‘˜ä¿¡æ¯
                const members = await apiClient.getMembers();
                const member = members.find(m => m.username === memberId || m.id === memberId);
                
                if (member) {
                    // å¡«å……åŸºæœ¬ä¿¡æ¯
                    document.getElementById('detailUsername').textContent = member.username || '-';
                    document.getElementById('detailEmail').textContent = member.email || '-';
                    document.getElementById('detailPhone').textContent = member.phone || '-';
                    document.getElementById('detailCity').textContent = member.city || '-';
                    document.getElementById('detailJoinedAt').textContent = member.joined_at ? new Date(member.joined_at).toLocaleString('zh-CN') : '-';
                    
                    // è·å–é’±åŒ…ä¿¡æ¯
                    const walletResult = await apiClient.getWallet(member.id);
                    if (walletResult.success) {
                        document.getElementById('detailWalletBalance').textContent = `Â¥${walletResult.wallet.balance.toFixed(2)}`;
                    }
                    
                    // æ˜¾ç¤ºæ¨¡æ€æ¡†
                    document.getElementById('memberDetailModal').style.display = 'block';
                } else {
                    showMessageDialog('æç¤º', 'æœªæ‰¾åˆ°ä¼šå‘˜ä¿¡æ¯');
                }
            } catch (error) {
                console.error('åŠ è½½ä¼šå‘˜è¯¦æƒ…å¤±è´¥:', error);
                showMessageDialog('æç¤º', 'åŠ è½½ä¼šå‘˜è¯¦æƒ…å¤±è´¥ï¼Œè¯·é‡è¯•');
            }
        }

        // å…³é—­ä¼šå‘˜è¯¦æƒ…æ¨¡æ€æ¡†
        function closeMemberDetailModal() {
            document.getElementById('memberDetailModal').style.display = 'none';
            document.getElementById('memberTransactions').style.display = 'none';
            document.getElementById('transactionsList').innerHTML = '';
            currentMemberId = null;
        }

        // æ˜¾ç¤ºé’±åŒ…äº¤æ˜“è®°å½•
        async function showWalletTransactions() {
            if (!currentMemberId) return;
            
            try {
                const members = await apiClient.getMembers();
                const member = members.find(m => m.username === currentMemberId || m.id === currentMemberId);
                
                if (member) {
                    const transactionsResult = await apiClient.getWalletTransactions(member.id);
                    const transactionsList = document.getElementById('transactionsList');
                    
                    if (transactionsResult.success && transactionsResult.transactions.length > 0) {
                        transactionsList.innerHTML = transactionsResult.transactions.map(transaction => `
                            <div class="transaction-item ${transaction.type}">
                                <div class="transaction-info">
                                    <div class="transaction-type ${transaction.type}">
                                        ${transaction.type === 'deposit' ? 'ğŸ’° å……å€¼' : 'ğŸ’¸ ææ¬¾'}
                                    </div>
                                    <div class="transaction-date">${new Date(transaction.created_at).toLocaleString('zh-CN')}</div>
                                    <div class="transaction-description">${transaction.description || ''}</div>
                                </div>
                                <div class="transaction-amount ${transaction.type}">
                                    ${transaction.type === 'deposit' ? '+' : '-'}Â¥${transaction.amount.toFixed(2)}
                                </div>
                            </div>
                        `).join('');
                    } else {
                        transactionsList.innerHTML = '<p style="text-align: center; color: #888;">æš‚æ— äº¤æ˜“è®°å½•</p>';
                    }
                    
                    document.getElementById('memberTransactions').style.display = 'block';
                }
            } catch (error) {
                console.error('åŠ è½½äº¤æ˜“è®°å½•å¤±è´¥:', error);
                showMessageDialog('æç¤º', 'åŠ è½½äº¤æ˜“è®°å½•å¤±è´¥ï¼Œè¯·é‡è¯•');
            }
        }

        // éšè—é’±åŒ…äº¤æ˜“è®°å½•
        function hideWalletTransactions() {
            document.getElementById('memberTransactions').style.display = 'none';
        }

        // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
        window.onclick = function(event) {
            const memberDetailModal = document.getElementById('memberDetailModal');
            const editMemberModal = document.getElementById('editMemberModal');
            const resetPasswordModal = document.getElementById('resetPasswordModal');
            
            if (event.target === memberDetailModal) {
                closeMemberDetailModal();
            }
            if (event.target === editMemberModal) {
                closeEditMemberModal();
            }
            if (event.target === resetPasswordModal) {
                closeResetPasswordModal();
            }
        }

        // é¡µé¢åŠ è½½å®ŒæˆååŠ è½½é’±åŒ…ä½™é¢
        document.addEventListener('DOMContentLoaded', function() {
            // å»¶è¿ŸåŠ è½½é’±åŒ…ä½™é¢ï¼Œç¡®ä¿é¡µé¢å®Œå…¨åŠ è½½
            setTimeout(() => {
                loadMemberWalletBalances();
            }, 1000);
        });

        // ä¼šå‘˜åˆ—è¡¨ç®¡ç†åŠŸèƒ½
        let allMembers = [];
        let filteredMembers = [];
        let currentPage = 1;
        const membersPerPage = 20;

        // åŠ è½½ä¼šå‘˜åˆ—è¡¨
        async function loadMemberList() {
            try {
                document.getElementById('memberListLoading').style.display = 'block';
                document.getElementById('memberListEmpty').style.display = 'none';
                document.getElementById('memberListTableBody').innerHTML = '';

                const members = await apiClient.getMembers();
                allMembers = members;
                filteredMembers = members;
                
                // è·å–æ¯ä¸ªä¼šå‘˜çš„é¢å¤–ä¿¡æ¯ï¼ˆææ¬¾æ€»é¢ã€é’±åŒ…ä½™é¢ç­‰ï¼‰
                await Promise.all(members.map(async (member) => {
                    try {
                        // è·å–ææ¬¾æ€»é¢
                        const donationsResult = await apiClient.getUserDonations(member.id);
                        member.totalDonations = donationsResult.success ? donationsResult.total_amount : 0;
                        
                        // è·å–é’±åŒ…ä½™é¢
                        const walletResult = await apiClient.getWallet(member.id);
                        member.walletBalance = walletResult.success ? walletResult.wallet.balance : 0;
                        
                        // ç¡®å®šçŠ¶æ€ï¼ˆç®€åŒ–å¤„ç†ï¼‰
                        member.status = 'active'; // é»˜è®¤ä¸ºæ´»è·ƒçŠ¶æ€
                        member.lastActive = member.joined_at; // ä½¿ç”¨æ³¨å†Œæ—¶é—´ä½œä¸ºæœ€åæ´»è·ƒæ—¶é—´
                        
                    } catch (error) {
                        console.error(`è·å–ä¼šå‘˜ ${member.id} é¢å¤–ä¿¡æ¯å¤±è´¥:`, error);
                        member.totalDonations = 0;
                        member.walletBalance = 0;
                        member.status = 'active';
                        member.lastActive = member.joined_at;
                    }
                }));

                displayMemberList();
                updateMemberStats();
                
            } catch (error) {
                console.error('åŠ è½½ä¼šå‘˜åˆ—è¡¨å¤±è´¥:', error);
                document.getElementById('memberListLoading').style.display = 'none';
                document.getElementById('memberListEmpty').style.display = 'block';
                document.getElementById('memberListEmpty').innerHTML = '<p>åŠ è½½ä¼šå‘˜åˆ—è¡¨å¤±è´¥ï¼Œè¯·é‡è¯•</p>';
            }
        }

        // æ˜¾ç¤ºä¼šå‘˜åˆ—è¡¨
        function displayMemberList() {
            const startIndex = (currentPage - 1) * membersPerPage;
            const endIndex = startIndex + membersPerPage;
            const pageMembers = filteredMembers.slice(startIndex, endIndex);
            
            const tbody = document.getElementById('memberListTableBody');
            tbody.innerHTML = '';
            
            if (pageMembers.length === 0) {
                document.getElementById('memberListEmpty').style.display = 'block';
                document.getElementById('memberListLoading').style.display = 'none';
                return;
            }
            
            document.getElementById('memberListEmpty').style.display = 'none';
            document.getElementById('memberListLoading').style.display = 'none';
            
            pageMembers.forEach(member => {
                const row = document.createElement('tr');
                const statusClass = member.status === 'active' ? 'active' : member.status === 'suspended' ? 'suspended' : 'inactive';
                const statusText = member.status === 'active' ? 'æ´»è·ƒ' : member.status === 'suspended' ? 'æš‚åœ' : 'ç¦»çº¿';
                
                row.innerHTML = `
                    <td>${member.id}</td>
                    <td>${member.username}</td>
                    <td><span class="member-position position-${member.position || 'æ™®é€šä¼šå‘˜'}">${member.position || 'æ™®é€šä¼šå‘˜'}</span></td>
                    <td>${member.email || '-'}</td>
                    <td>${member.phone || '-'}</td>
                    <td>${member.city || '-'}</td>
                    <td><span class="member-level">${member.level || '1çº§'}</span></td>
                    <td>Â¥${member.totalDonations.toFixed(2)}</td>
                    <td>Â¥${member.walletBalance.toFixed(2)}</td>
                    <td>${new Date(member.joined_at).toLocaleDateString('zh-CN')}</td>
                    <td>${new Date(member.lastActive).toLocaleDateString('zh-CN')}</td>
                    <td><span class="member-status ${statusClass}">${statusText}</span></td>
                    <td>
                        <button class="member-action-btn view" onclick="viewMemberDetails('${member.id}')" title="æŸ¥çœ‹è¯¦æƒ…">ğŸ‘ï¸</button>
                        <button class="member-action-btn edit" onclick="editMember('${member.id}')" title="ç¼–è¾‘">âœï¸</button>
                        <button class="member-action-btn position" onclick="setMemberPosition('${member.id}')" title="è®¾ç½®èŒä½">ğŸ‘‘</button>
                        <button class="member-action-btn password" onclick="changeMemberPassword('${member.id}')" title="ä¿®æ”¹å¯†ç ">ğŸ”‘</button>
                        <button class="member-action-btn suspend" onclick="toggleMemberStatus('${member.id}')" title="${member.status === 'suspended' ? 'æ¢å¤' : 'æš‚åœ'}">${member.status === 'suspended' ? 'â–¶ï¸' : 'â¸ï¸'}</button>
                        <button class="member-action-btn delete" onclick="deleteMember('${member.id}')" title="åˆ é™¤">ğŸ—‘ï¸</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
            
            // æ›´æ–°åˆ†é¡µæŒ‰é’®çŠ¶æ€
            document.getElementById('currentPage').textContent = currentPage;
            document.getElementById('prevPageBtn').disabled = currentPage === 1;
            document.getElementById('nextPageBtn').disabled = endIndex >= filteredMembers.length;
        }

        // æ›´æ–°ä¼šå‘˜ç»Ÿè®¡
        function updateMemberStats() {
            document.getElementById('totalMemberCount').textContent = filteredMembers.length;
            
            const onlineCount = filteredMembers.filter(m => m.status === 'active').length;
            document.getElementById('onlineMemberCount').textContent = onlineCount;
            
            // è®¡ç®—30å¤©å†…æ´»è·ƒçš„ä¼šå‘˜ï¼ˆç®€åŒ–å¤„ç†ï¼‰
            const thirtyDaysAgo = new Date();
            thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);
            const activeCount = filteredMembers.filter(m => new Date(m.lastActive) > thirtyDaysAgo).length;
            document.getElementById('activeMemberCount').textContent = activeCount;
        }

        // æœç´¢ä¼šå‘˜
        function searchMembers() {
            const searchTerm = document.getElementById('memberSearchInput').value.toLowerCase();
            const levelFilter = document.getElementById('memberLevelFilter').value;
            
            filteredMembers = allMembers.filter(member => {
                const matchesSearch = !searchTerm || 
                    member.username.toLowerCase().includes(searchTerm) ||
                    (member.email && member.email.toLowerCase().includes(searchTerm)) ||
                    (member.phone && member.phone.includes(searchTerm));
                
                const matchesLevel = !levelFilter || (member.level || '1çº§') === levelFilter + 'çº§';
                
                return matchesSearch && matchesLevel;
            });
            
            currentPage = 1;
            displayMemberList();
            updateMemberStats();
        }

        // é‡ç½®æœç´¢
        function resetMemberSearch() {
            document.getElementById('memberSearchInput').value = '';
            document.getElementById('memberLevelFilter').value = '';
            filteredMembers = allMembers;
            currentPage = 1;
            displayMemberList();
            updateMemberStats();
        }

        // åˆ†é¡µåŠŸèƒ½
        function loadPreviousPage() {
            if (currentPage > 1) {
                currentPage--;
                displayMemberList();
            }
        }

        function loadNextPage() {
            const maxPage = Math.ceil(filteredMembers.length / membersPerPage);
            if (currentPage < maxPage) {
                currentPage++;
                displayMemberList();
            }
        }

        // å¯¼å‡ºä¼šå‘˜åˆ—è¡¨
        function exportMemberList() {
            const csvContent = [
                ['ä¼šå‘˜ID', 'ç”¨æˆ·å', 'èŒä½', 'é‚®ç®±', 'æ‰‹æœº', 'åŸå¸‚', 'ä¼šå‘˜ç­‰çº§', 'ç´¯è®¡ææ¬¾', 'é’±åŒ…ä½™é¢', 'æ³¨å†Œæ—¶é—´', 'çŠ¶æ€'],
                ...filteredMembers.map(member => [
                    member.id,
                    member.username,
                    member.position || 'æ™®é€šä¼šå‘˜',
                    member.email || '',
                    member.phone || '',
                    member.city || '',
                    member.level || '1çº§',
                    member.totalDonations.toFixed(2),
                    member.walletBalance.toFixed(2),
                    new Date(member.joined_at).toLocaleDateString('zh-CN'),
                    member.status === 'active' ? 'æ´»è·ƒ' : member.status === 'suspended' ? 'æš‚åœ' : 'ç¦»çº¿'
                ])
            ].map(row => row.join(',')).join('\n');
            
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `ä¼šå‘˜åˆ—è¡¨_${new Date().toLocaleDateString('zh-CN')}.csv`;
            link.click();
        }

        // ç¼–è¾‘ä¼šå‘˜ï¼ˆç®€åŒ–å¤„ç†ï¼‰
        let currentEditingMember = null;

        function editMember(memberId) {
            const member = allMembers.find(m => m.id === memberId);
            if (member) {
                currentEditingMember = member;
                
                // å¡«å……å½“å‰ä¼šå‘˜ä¿¡æ¯åˆ°è¡¨å•
                document.getElementById('editMemberUsername').value = member.username || '';
                document.getElementById('editMemberEmail').value = member.email || '';
                document.getElementById('editMemberPhone').value = member.phone || '';
                document.getElementById('editMemberCity').value = member.city || '';
                
                // æ˜¾ç¤ºç¼–è¾‘æ¨¡æ€æ¡†
                document.getElementById('editMemberModal').style.display = 'block';
            }
        }

        // ç¡®è®¤ç¼–è¾‘ä¼šå‘˜
        function confirmEditMember() {
            if (!currentEditingMember) return;
            
            const newUsername = document.getElementById('editMemberUsername').value.trim();
            const newEmail = document.getElementById('editMemberEmail').value.trim();
            const newPhone = document.getElementById('editMemberPhone').value.trim();
            const newCity = document.getElementById('editMemberCity').value.trim();
            
            if (!newUsername) {
                showMessageDialog('é”™è¯¯', 'ç”¨æˆ·åä¸èƒ½ä¸ºç©ºï¼');
                return;
            }
            
            // æ›´æ–°ä¼šå‘˜ä¿¡æ¯
            currentEditingMember.username = newUsername;
            currentEditingMember.email = newEmail;
            currentEditingMember.phone = newPhone;
            currentEditingMember.city = newCity;
            
            // è¿™é‡Œåº”è¯¥è°ƒç”¨APIæ›´æ–°ä¼šå‘˜ä¿¡æ¯
            showMessageDialog('æˆåŠŸ', 'ä¼šå‘˜ä¿¡æ¯å·²æ›´æ–°ï¼ˆæœ¬åœ°æ¼”ç¤ºï¼‰');
            
            // åˆ·æ–°æ˜¾ç¤º
            displayMemberList();
            
            // å…³é—­æ¨¡æ€æ¡†
            closeEditMemberModal();
        }

        // å…³é—­ç¼–è¾‘ä¼šå‘˜æ¨¡æ€æ¡†
        function closeEditMemberModal() {
            document.getElementById('editMemberModal').style.display = 'none';
            currentEditingMember = null;
        }

        // è‡ªå®šä¹‰ç¡®è®¤å¯¹è¯æ¡†
        function showConfirmDialog(title, message, onConfirm) {
            document.getElementById('confirmModalTitle').textContent = title;
            document.getElementById('confirmModalMessage').textContent = message;
            document.getElementById('confirmModal').style.display = 'block';
            
            // è®¾ç½®ç¡®è®¤æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶
            const confirmBtn = document.getElementById('confirmModalOk');
            confirmBtn.onclick = function() {
                closeConfirmModal();
                if (onConfirm) onConfirm();
            };
        }

        // å…³é—­ç¡®è®¤å¯¹è¯æ¡†
        function closeConfirmModal() {
            document.getElementById('confirmModal').style.display = 'none';
        }

        // è‡ªå®šä¹‰æ¶ˆæ¯æç¤ºæ¡†
        function showMessageDialog(title, message) {
            document.getElementById('messageModalTitle').textContent = title;
            document.getElementById('messageModalMessage').textContent = message;
            document.getElementById('messageModal').style.display = 'block';
        }

        // å…³é—­æ¶ˆæ¯æç¤ºæ¡†
        function closeMessageModal() {
            document.getElementById('messageModal').style.display = 'none';
        }

        // ä¸€é”®æ³¨å†Œä¼šå‘˜ç›¸å…³åŠŸèƒ½
        function showOneClickRegistrationModal() {
            document.getElementById('oneClickRegistrationModal').style.display = 'block';
            // é»˜è®¤ç”Ÿæˆä¸€ä¸ªå¯†ç 
            generateRandomPassword();
        }

        function closeOneClickRegistrationModal() {
            document.getElementById('oneClickRegistrationModal').style.display = 'none';
            // æ¸…ç©ºè¡¨å•
            document.getElementById('registrationCount').value = '1';
            document.getElementById('memberLevelSelect').value = '1';
            document.getElementById('autoPassword').value = '';
            document.getElementById('autoActivate').checked = true;
        }

        function closeRegistrationResultModal() {
            document.getElementById('registrationResultModal').style.display = 'none';
            document.getElementById('registrationResults').innerHTML = '';
        }

        // ç”Ÿæˆéšæœºå¯†ç 
        function generateRandomPassword() {
            const length = 12;
            const charset = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%';
            let password = '';
            for (let i = 0; i < length; i++) {
                password += charset.charAt(Math.floor(Math.random() * charset.length));
            }
            document.getElementById('autoPassword').value = password;
            return password;
        }

        // ç”Ÿæˆä¼šå‘˜å·
        function generateMemberNumber() {
            const timestamp = Date.now().toString().slice(-6);
            const random = Math.floor(Math.random() * 1000).toString().padStart(3, '0');
            return 'M' + timestamp + random;
        }

        // ç¡®è®¤ä¸€é”®æ³¨å†Œ
        async function confirmOneClickRegistration() {
            const count = parseInt(document.getElementById('registrationCount').value);
            const level = parseInt(document.getElementById('memberLevelSelect').value);
            const password = document.getElementById('autoPassword').value;
            const autoActivate = document.getElementById('autoActivate').checked;

            if (!password) {
                showMessageDialog('æç¤º', 'è¯·ç”Ÿæˆå¯†ç æˆ–è¾“å…¥å¯†ç ');
                return;
            }

            if (count < 1 || count > 10) {
                showMessageDialog('æç¤º', 'æ³¨å†Œæ•°é‡å¿…é¡»åœ¨1-10ä¹‹é—´');
                return;
            }

            showConfirmDialog('ç¡®è®¤æ³¨å†Œ', `ç¡®å®šè¦æ³¨å†Œ ${count} ä¸ªä¼šå‘˜è´¦å·å—ï¼Ÿ`, async () => {
                closeOneClickRegistrationModal();
                await performBatchRegistration(count, level, password, autoActivate);
            });
        }

        // æ‰§è¡Œæ‰¹é‡æ³¨å†Œ
        async function performBatchRegistration(count, level, password, autoActivate) {
            const results = [];
            const registrationResults = document.getElementById('registrationResults');
            
            registrationResults.innerHTML = '<div style="text-align: center; padding: 20px;"><p>æ­£åœ¨æ³¨å†Œä¼šå‘˜ï¼Œè¯·ç¨å€™...</p></div>';
            document.getElementById('registrationResultModal').style.display = 'block';

            for (let i = 0; i < count; i++) {
                try {
                    const memberNumber = generateMemberNumber();
                    const username = `ç”¨æˆ·${memberNumber}`;
                    const email = `user_${memberNumber}@xianhou.com`;
                    
                    const memberData = {
                        username: username,
                        email: email,
                        phone: '',
                        city: 'æœªçŸ¥',
                        level: level,
                        status: autoActivate ? 'active' : 'pending',
                        password: password,
                        memberNumber: memberNumber
                    };

                    // ä½¿ç”¨ç°æœ‰çš„ä¼šå‘˜æ³¨å†ŒAPI
                    const result = await apiClient.request('/api/members', {
                        method: 'POST',
                        body: JSON.stringify(memberData)
                    });

                    if (result.success) {
                        results.push({
                            success: true,
                            username: username,
                            email: email,
                            memberNumber: memberNumber,
                            password: password,
                            message: 'æ³¨å†ŒæˆåŠŸ'
                        });
                    } else {
                        results.push({
                            success: false,
                            username: username,
                            error: result.message || 'æ³¨å†Œå¤±è´¥'
                        });
                    }
                } catch (error) {
                    results.push({
                        success: false,
                        error: error.message || 'ç½‘ç»œé”™è¯¯'
                    });
                }

                // æ›´æ–°è¿›åº¦
                registrationResults.innerHTML = `
                    <div style="text-align: center; padding: 20px;">
                        <p>æ³¨å†Œè¿›åº¦: ${i + 1}/${count}</p>
                        <div style="width: 100%; background: rgba(255,255,255,0.1); border-radius: 10px; height: 8px; margin-top: 10px;">
                            <div style="width: ${((i + 1) / count) * 100}%; background: #00ff88; height: 100%; border-radius: 10px; transition: width 0.3s;"></div>
                        </div>
                    </div>
                `;
            }

            // æ˜¾ç¤ºæœ€ç»ˆç»“æœ
            displayRegistrationResults(results);
            
            // åˆ·æ–°ä¼šå‘˜åˆ—è¡¨
            if (results.some(r => r.success)) {
                loadMembers();
            }
        }

        // æ˜¾ç¤ºæ³¨å†Œç»“æœ
        function displayRegistrationResults(results) {
            const registrationResults = document.getElementById('registrationResults');
            const successCount = results.filter(r => r.success).length;
            const failCount = results.filter(r => !r.success).length;

            let html = `
                <div style="margin-bottom: 20px; padding: 15px; background: rgba(0,255,136,0.1); border-radius: 8px; border-left: 4px solid #00ff88;">
                    <h4 style="color: #00ff88; margin: 0 0 10px 0;">æ³¨å†Œç»Ÿè®¡</h4>
                    <p style="margin: 5px 0;">æˆåŠŸ: <strong style="color: #00ff88;">${successCount}</strong></p>
                    <p style="margin: 5px 0;">å¤±è´¥: <strong style="color: #ff6b6b;">${failCount}</strong></p>
                </div>
            `;

            if (successCount > 0) {
                html += `
                    <div style="margin-bottom: 20px;">
                        <h4 style="color: #00ff88;">æˆåŠŸæ³¨å†Œçš„ä¼šå‘˜</h4>
                        <div style="max-height: 200px; overflow-y: auto;">
                `;
                results.filter(r => r.success).forEach(result => {
                    html += `
                        <div style="padding: 10px; margin: 5px 0; background: rgba(0,255,136,0.05); border-radius: 5px; border-left: 3px solid #00ff88;">
                            <strong>${result.username}</strong> (${result.memberNumber})<br>
                            <small style="color: #ccc;">é‚®ç®±: ${result.email}</small><br>
                            <small style="color: #ccc;">å¯†ç : ${result.password}</small>
                        </div>
                    `;
                });
                html += '</div></div>';
            }

            if (failCount > 0) {
                html += `
                    <div>
                        <h4 style="color: #ff6b6b;">æ³¨å†Œå¤±è´¥çš„è´¦å·</h4>
                        <div style="max-height: 150px; overflow-y: auto;">
                `;
                results.filter(r => !r.success).forEach(result => {
                    html += `
                        <div style="padding: 10px; margin: 5px 0; background: rgba(255,107,107,0.05); border-radius: 5px; border-left: 3px solid #ff6b6b;">
                            <strong>${result.username || 'æœªçŸ¥'}</strong><br>
                            <small style="color: #ff6b6b;">é”™è¯¯: ${result.error}</small>
                        </div>
                    `;
                });
                html += '</div></div>';
            }

            registrationResults.innerHTML = html;
        }

        // å¯¼å‡ºæ³¨å†Œç»“æœ
        function exportRegistrationResults() {
            const resultsText = document.getElementById('registrationResults').innerText;
            const blob = new Blob([resultsText], { type: 'text/plain;charset=utf-8' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `ä¼šå‘˜æ³¨å†Œç»“æœ_${new Date().toLocaleDateString('zh-CN')}.txt`;
            link.click();
        }

        // èŒä½è®¾ç½®ç›¸å…³åŠŸèƒ½
        let currentMemberForPosition = null;

        function closeSetPositionModal() {
            document.getElementById('setPositionModal').style.display = 'none';
            document.getElementById('memberPositionSelect').value = '';
            document.getElementById('customPositionInput').value = '';
            document.getElementById('customPositionGroup').style.display = 'none';
            document.getElementById('positionStartDate').value = '';
            document.getElementById('positionEndDate').value = '';
            document.getElementById('positionNotes').value = '';
            currentMemberForPosition = null;
        }

        // ç›‘å¬èŒä½é€‰æ‹©å˜åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            const positionSelect = document.getElementById('memberPositionSelect');
            if (positionSelect) {
                positionSelect.addEventListener('change', function() {
                    const customGroup = document.getElementById('customPositionGroup');
                    if (this.value === 'è‡ªå®šä¹‰') {
                        customGroup.style.display = 'block';
                    } else {
                        customGroup.style.display = 'none';
                    }
                });
            }
        });

        // è®¾ç½®ä¼šå‘˜èŒä½
        function setMemberPosition(memberId) {
            const member = allMembers.find(m => m.id === memberId);
            if (!member) {
                showMessageDialog('é”™è¯¯', 'æœªæ‰¾åˆ°ä¼šå‘˜ä¿¡æ¯');
                return;
            }

            currentMemberForPosition = member;
            
            // å¡«å……å½“å‰èŒä½ä¿¡æ¯ï¼ˆå¦‚æœæœ‰ï¼‰
            if (member.position) {
                const predefinedPositions = ['å‰ä¸»å¸­', 'ä¸»å¸­', 'å‰¯ä¸»å¸­', 'è´¢æ”¿', 'å¤–äº¤', 'è”è°Šä¼šè´·æ¬¾', 'ç†äº‹', 'å«ç”Ÿéƒ¨éƒ¨é•¿', 'æ‰“æ‰‹', 'è½¦æ‰‹'];
                if (predefinedPositions.includes(member.position)) {
                    document.getElementById('memberPositionSelect').value = member.position;
                    document.getElementById('customPositionGroup').style.display = 'none';
                } else {
                    document.getElementById('memberPositionSelect').value = 'è‡ªå®šä¹‰';
                    document.getElementById('customPositionInput').value = member.position;
                    document.getElementById('customPositionGroup').style.display = 'block';
                }
            } else {
                document.getElementById('memberPositionSelect').value = '';
                document.getElementById('customPositionGroup').style.display = 'none';
            }

            // è®¾ç½®é»˜è®¤å¼€å§‹æ—¥æœŸä¸ºä»Šå¤©
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('positionStartDate').value = today;
            
            // æ¸…ç©ºå…¶ä»–å­—æ®µ
            document.getElementById('positionEndDate').value = '';
            document.getElementById('positionNotes').value = '';

            document.getElementById('setPositionModal').style.display = 'block';
        }

        // ç¡®è®¤è®¾ç½®èŒä½
        async function confirmSetPosition() {
            if (!currentMemberForPosition) {
                showMessageDialog('é”™è¯¯', 'æœªé€‰æ‹©ä¼šå‘˜');
                return;
            }

            const positionSelect = document.getElementById('memberPositionSelect').value;
            let finalPosition = '';

            if (positionSelect === 'è‡ªå®šä¹‰') {
                finalPosition = document.getElementById('customPositionInput').value.trim();
                if (!finalPosition) {
                    showMessageDialog('æç¤º', 'è¯·è¾“å…¥è‡ªå®šä¹‰èŒä½åç§°');
                    return;
                }
            } else {
                finalPosition = positionSelect;
            }

            const startDate = document.getElementById('positionStartDate').value;
            const endDate = document.getElementById('positionEndDate').value;
            const notes = document.getElementById('positionNotes').value;

            if (!startDate) {
                showMessageDialog('æç¤º', 'è¯·é€‰æ‹©ä»»èŒå¼€å§‹æ—¥æœŸ');
                return;
            }

            const positionData = {
                position: finalPosition,
                positionStartDate: startDate,
                positionEndDate: endDate || null,
                positionNotes: notes
            };

            try {
                const result = await apiClient.request(`/api/members/${currentMemberForPosition.id}`, {
                    method: 'PUT',
                    body: JSON.stringify(positionData)
                });

                if (result.success) {
                    showMessageDialog('æˆåŠŸ', 'èŒä½è®¾ç½®æˆåŠŸï¼');
                    
                    // æ›´æ–°æœ¬åœ°æ•°æ® - ç¡®ä¿å¯¹è±¡å­˜åœ¨
                    if (currentMemberForPosition) {
                        currentMemberForPosition.position = finalPosition;
                        currentMemberForPosition.positionStartDate = startDate;
                        currentMemberForPosition.positionEndDate = endDate || null;
                        currentMemberForPosition.positionNotes = notes;
                    }
                    
                    // åˆ·æ–°ä¼šå‘˜åˆ—è¡¨
                    displayMemberList();
                    
                    // æœ€åå…³é—­æ¨¡æ€æ¡†ï¼ˆä¼šæ¸…ç©ºcurrentMemberForPositionï¼‰
                    closeSetPositionModal();
                } else {
                    showMessageDialog('é”™è¯¯', result.message || 'èŒä½è®¾ç½®å¤±è´¥');
                }
            } catch (error) {
                console.error('è®¾ç½®èŒä½å¤±è´¥:', error);
                showMessageDialog('é”™è¯¯', 'ç½‘ç»œé”™è¯¯ï¼Œè¯·é‡è¯•');
            }
        }

        // ä¿®æ”¹ä¼šå‘˜å¯†ç 
        function changeMemberPassword(memberId) {
            const member = allMembers.find(m => m.id === memberId);
            if (!member) {
                showMessageDialog('é”™è¯¯', 'æœªæ‰¾åˆ°ä¼šå‘˜ä¿¡æ¯');
                return;
            }

            currentMemberForPassword = member;
            
            // å¡«å……ä¼šå‘˜åç§°
            document.getElementById('changePasswordMemberName').value = member.username;
            
            // æ¸…ç©ºå¯†ç è¾“å…¥æ¡†
            document.getElementById('newPassword').value = '';
            document.getElementById('confirmNewPassword').value = '';
            
            // æ˜¾ç¤ºæ¨¡æ€æ¡†
            document.getElementById('changePasswordModal').style.display = 'block';
        }

        // å…³é—­ä¿®æ”¹å¯†ç æ¨¡æ€æ¡†
        function closeChangePasswordModal() {
            document.getElementById('changePasswordModal').style.display = 'none';
            currentMemberForPassword = null;
        }

        // ç¡®è®¤ä¿®æ”¹å¯†ç 
        async function confirmChangePassword() {
            if (!currentMemberForPassword) {
                showMessageDialog('é”™è¯¯', 'æœªé€‰æ‹©ä¼šå‘˜');
                return;
            }

            const newPassword = document.getElementById('newPassword').value.trim();
            const confirmPassword = document.getElementById('confirmNewPassword').value.trim();

            // éªŒè¯è¾“å…¥
            if (!newPassword) {
                showMessageDialog('é”™è¯¯', 'è¯·è¾“å…¥æ–°å¯†ç ');
                return;
            }

            if (newPassword.length < 6) {
                showMessageDialog('é”™è¯¯', 'å¯†ç é•¿åº¦è‡³å°‘ä¸º6ä½');
                return;
            }

            if (newPassword !== confirmPassword) {
                showMessageDialog('é”™è¯¯', 'ä¸¤æ¬¡è¾“å…¥çš„å¯†ç ä¸ä¸€è‡´');
                return;
            }

            // è·å–ç®¡ç†å‘˜ä»¤ç‰Œ
            const currentAdmin = JSON.parse(localStorage.getItem('currentAdmin') || '{}');
            if (!currentAdmin.sessionToken) {
                showMessageDialog('é”™è¯¯', 'ç®¡ç†å‘˜ä¼šè¯å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•');
                return;
            }

            try {
                const response = await fetch('/api/admin/change-password', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        token: currentAdmin.sessionToken,
                        memberId: currentMemberForPassword.id,
                        newPassword: newPassword
                    })
                });

                const result = await response.json();

                if (result.success) {
                    showMessageDialog('æˆåŠŸ', 'å¯†ç ä¿®æ”¹æˆåŠŸï¼');
                    closeChangePasswordModal();
                } else {
                    showMessageDialog('é”™è¯¯', result.message || 'å¯†ç ä¿®æ”¹å¤±è´¥');
                }
            } catch (error) {
                console.error('ä¿®æ”¹å¯†ç å¤±è´¥:', error);
                showMessageDialog('é”™è¯¯', 'ç½‘ç»œé”™è¯¯ï¼Œè¯·é‡è¯•');
            }
        }

        // è·å–èŒä½æ˜¾ç¤ºæ ·å¼
        function getPositionStyle(position) {
            const positionStyles = {
                'å‰ä¸»å¸­': { icon: 'ğŸ›ï¸', color: '#FFD700' },
                'ä¸»å¸­': { icon: 'ğŸ‘‘', color: '#FF6B35' },
                'å‰¯ä¸»å¸­': { icon: 'ğŸ‘‘', color: '#FF8E53' },
                'è´¢æ”¿': { icon: 'ğŸ’°', color: '#00FF88' },
                'å¤–äº¤': { icon: 'ğŸ¤', color: '#87CEEB' },
                'è”è°Šä¼šè´·æ¬¾': { icon: 'ğŸ’³', color: '#9370DB' },
                'ç†äº‹': { icon: 'ğŸ“‹', color: '#4682B4' },
                'å«ç”Ÿéƒ¨éƒ¨é•¿': { icon: 'ğŸ§¹', color: '#32CD32' },
                'æ‰“æ‰‹': { icon: 'ğŸ’ª', color: '#DC143C' },
                'è½¦æ‰‹': { icon: 'ğŸï¸', color: '#FF1493' }
            };

            return positionStyles[position] || { icon: 'ğŸ‘¤', color: '#CCCCCC' };
        }

        // åˆ‡æ¢ä¼šå‘˜çŠ¶æ€
        function toggleMemberStatus(memberId) {
            const member = allMembers.find(m => m.id === memberId);
            if (member) {
                const newStatus = member.status === 'suspended' ? 'active' : 'suspended';
                const statusText = newStatus === 'suspended' ? 'æš‚åœ' : 'æ´»è·ƒ';
                
                showConfirmDialog(
                    'ç¡®è®¤æ“ä½œ',
                    `ç¡®å®šè¦å°†ä¼šå‘˜çŠ¶æ€æ›´æ–°ä¸º: ${statusText}å—ï¼Ÿ`,
                    function() {
                        member.status = newStatus;
                        // è¿™é‡Œåº”è¯¥è°ƒç”¨APIæ›´æ–°ä¼šå‘˜çŠ¶æ€
                        showMessageDialog('æˆåŠŸ', `ä¼šå‘˜çŠ¶æ€å·²æ›´æ–°ä¸º: ${statusText}ï¼ˆæœ¬åœ°æ¼”ç¤ºï¼‰`);
                        displayMemberList();
                    }
                );
            }
        }

        // åˆ é™¤ä¼šå‘˜ï¼ˆç®€åŒ–å¤„ç†ï¼‰
        function deleteMember(memberId) {
            showConfirmDialog(
                'åˆ é™¤ç¡®è®¤',
                'ç¡®å®šè¦åˆ é™¤è¯¥ä¼šå‘˜å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚',
                function() {
                    const index = allMembers.findIndex(m => m.id === memberId);
                    if (index > -1) {
                        allMembers.splice(index, 1);
                        filteredMembers = allMembers;
                        // è¿™é‡Œåº”è¯¥è°ƒç”¨APIåˆ é™¤ä¼šå‘˜
                        showMessageDialog('æˆåŠŸ', 'ä¼šå‘˜å·²åˆ é™¤ï¼ˆæœ¬åœ°æ¼”ç¤ºï¼‰');
                        displayMemberList();
                        updateMemberStats();
                    }
                }
            );
        }

        // ä¿®æ”¹åŸæœ‰çš„showTabå‡½æ•°ï¼Œåœ¨åˆ‡æ¢åˆ°ä¼šå‘˜åˆ—è¡¨æ—¶åŠ è½½æ•°æ®
        const originalShowTab = window.showTab;
        window.showTab = function(tabName, element) {
            // è°ƒç”¨åŸæœ‰çš„showTabå‡½æ•°
            if (originalShowTab) {
                originalShowTab(tabName, element);
            } else {
                // å¦‚æœæ²¡æœ‰åŸå‡½æ•°ï¼Œå®ç°åŸºæœ¬çš„æ ‡ç­¾åˆ‡æ¢
                const tabs = document.querySelectorAll('.tab-content');
                tabs.forEach(tab => tab.style.display = 'none');
                document.getElementById(tabName + 'Tab').style.display = 'block';
                
                const buttons = document.querySelectorAll('.tab-btn');
                buttons.forEach(btn => btn.classList.remove('active'));
                element.classList.add('active');
            }
            
            // å¦‚æœæ˜¯ä¼šå‘˜åˆ—è¡¨æ ‡ç­¾ï¼ŒåŠ è½½æ•°æ®
            if (tabName === 'memberList') {
                loadMemberList();
            }
        };
    </script>
</body>
</html>