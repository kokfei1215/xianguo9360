<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¼šå‘˜ä¸­å¿ƒ - é—²ç‹—è”åˆä¼šï¼ˆJLPï¼‰</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* æ¨¡æ€æ¡†æ ·å¼ */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            border: 1px solid #00ff88;
            border-radius: 15px;
            margin: 10% auto;
            padding: 0;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 0 30px rgba(0, 255, 136, 0.3);
            animation: modalFadeIn 0.3s ease;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; transform: translateY(-50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .modal-header {
            background: rgba(0, 255, 136, 0.1);
            padding: 20px;
            border-bottom: 1px solid #00ff88;
            border-radius: 15px 15px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            margin: 0;
            color: #00ff88;
            font-size: 1.5rem;
        }

        .close {
            color: #00ff88;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .close:hover {
            color: #fff;
        }

        .modal-body {
            padding: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #00ff88;
            font-weight: bold;
        }

        .form-group input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #00ff88;
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.3);
            color: #fff;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-group input:focus {
            outline: none;
            border-color: #fff;
            box-shadow: 0 0 10px rgba(0, 255, 136, 0.5);
        }

        .form-actions {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
            margin-top: 30px;
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 14px;
            margin: 0 5px;
        }

        .btn-primary, .btn-secondary {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            background: #00ff88;
            color: #000;
        }

        .btn-secondary {
            background: #666;
            color: #fff;
        }

        .btn-primary:hover, .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        /* å¿«é€Ÿææ¬¾åŒºåŸŸæ ·å¼ */
        .quick-donation {
            background: rgba(0, 255, 136, 0.05);
            border: 1px solid #00ff88;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .wallet-payment-info {
            background: rgba(0, 255, 136, 0.1);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
        }

        .wallet-payment-info p {
            margin: 0;
            font-size: 16px;
            color: #00ff88;
        }

        .donation-amounts {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
            justify-content: center;
        }

        .amount-btn {
            padding: 10px 20px;
            border: 1px solid #00ff88;
            border-radius: 8px;
            background: #666;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .amount-btn:hover {
            background: #888;
            transform: translateY(-1px);
        }

        .amount-btn.selected {
            background: #00ff88;
            color: #000;
        }

        /* æ´»åŠ¨å¡ç‰‡æ ·å¼ */
        .upcoming-events {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .event-card {
            background: rgba(0, 255, 136, 0.05);
            border: 1px solid #00ff88;
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .event-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 255, 136, 0.2);
        }

        .event-card h4 {
            color: #00ff88;
            margin: 0 0 10px 0;
            font-size: 18px;
        }

        .event-card p {
            margin: 8px 0;
            color: #ccc;
            font-size: 14px;
        }

        .event-card .btn {
            margin-top: 15px;
            width: 100%;
        }

        /* è¡¨å•æ ·å¼å¢å¼º */
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #00ff88;
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.3);
            color: #fff;
            font-size: 14px;
            resize: vertical;
            min-height: 80px;
            transition: all 0.3s ease;
        }

        .form-group textarea:focus {
            outline: none;
            border-color: #fff;
            box-shadow: 0 0 10px rgba(0, 255, 136, 0.5);
        }
    </style>
    <link rel="icon" type="image/svg+xml" href="img/jlp-logo.svg">
    <link rel="icon" type="image/png" href="img/jlp-logo.png">
</head>
<body id="memberPage">
    <header>
        <div class="container">
            <div class="logo">
                <img class="site-logo" src="img/jlp-logo.svg" onerror="this.src='img/jlp-logo.png'" alt="é—²ç‹—è”åˆä¼šï¼ˆJLPï¼‰Logo">
                <h1 class="site-title">é—²ç‹—è”åˆä¼šï¼ˆJLPï¼‰</h1>
            </div>
            <nav>
                <ul>
                    <li><a href="index.html">é¦–é¡µ</a></li>
                    <li><a href="events.html">æ´»åŠ¨å±•ç¤º</a></li>
                    <li><a href="donation.html">ææ¬¾</a></li>
                    <li><a href="application.html">å…¥ä¼šç”³è¯·</a></li>
                    <li><a href="games.html">ä¼šå‘˜å°æ¸¸æˆ</a></li>
                    <li><a href="login.html">ç™»å½•</a></li>
                </ul>
            </nav>
            <div class="menu-toggle">
                <i class="fas fa-bars"></i>
            </div>
        </div>
    </header>

    <section class="page-header">
        <div class="container">
            <h1>ä¼šå‘˜ä¸­å¿ƒ</h1>
            <p>æŸ¥çœ‹ä¸ªäººèµ„æ–™ã€ææ¬¾ä¸æŠ¥åè®°å½•ï¼Œä»¥åŠä¼šå‘˜ç­‰çº§</p>
        </div>
    </section>

    <section class="member-dashboard">
        <div class="container">
            <div class="member-card">
                <div class="member-avatar">
                    <img id="memberAvatarImg" src="img/avatar-60.svg" alt="ä¼šå‘˜å¤´åƒ" style="width:120px;height:120px;border-radius:50%;object-fit:cover;">
                    <div class="avatar-actions" style="margin-top:10px;">
                        <input type="file" id="avatarInput" accept="image/*">
                        <button class="btn" id="saveAvatarBtn">ä¿å­˜å¤´åƒ</button>
                    </div>
                </div>
                <div class="member-info">
                    <h2 id="memberName">ä¼šå‘˜å§“å</h2>
                    <p>ä¼šå‘˜IDï¼š<strong id="memberId">-</strong></p>
                    <p id="memberEmail">é‚®ç®±</p>
                    <p>ä¼šå‘˜ç­‰çº§ï¼š<strong id="memberLevel">1çº§</strong></p>
                    <p>ç´¯è®¡ææ¬¾ï¼š<strong id="donationTotal">0.00</strong> å…ƒ</p>
                    <div class="wallet-info" style="margin: 15px 0; padding: 15px; background: rgba(0, 255, 136, 0.1); border-radius: 8px; border: 1px solid #00ff88;">
                        <h4 style="color: #00ff88; margin: 0 0 10px 0;">ğŸ’° æˆ‘çš„é’±åŒ…</h4>
                        <p style="margin: 5px 0;">ä½™é¢ï¼š<strong id="walletBalance" style="color: #00ff88; font-size: 18px;">0.00</strong> å…ƒ</p>
                        <div style="margin-top: 10px;">
                            <button class="btn btn-small" onclick="showWalletDeposit()" style="background: #00ff88; color: #000; margin-right: 10px;">ğŸ’µ å……å€¼</button>
                            <button class="btn btn-small" onclick="showWalletWithdraw()" style="background: #ff6b6b; color: #fff; margin-right: 10px;">ğŸ’¸ ææ¬¾</button>
                            <button class="btn btn-small" onclick="showWalletTransactions()" style="background: #666; color: #fff;">ğŸ“‹ äº¤æ˜“è®°å½•</button>
                        </div>
                    </div>
                    <div class="member-actions" style="margin-top: 15px;">
                        <button class="btn btn-small" onclick="showEditProfile()" style="background: #00ff88; color: #000;">âœï¸ ç¼–è¾‘èµ„æ–™</button>
                        <button class="btn btn-small" onclick="showChangePassword()" style="background: #ff6b6b; color: #fff;">ğŸ”’ ä¿®æ”¹å¯†ç </button>
                    </div>
                </div>
            </div>

            <div class="member-section">
                <h3>å·²æŠ¥åæ´»åŠ¨</h3>
                <table class="donations-table">
                    <thead>
                        <tr>
                            <th>æ´»åŠ¨åç§°</th>
                            <th>åœ°ç‚¹</th>
                            <th>æ—¶é—´</th>
                            <th>æŠ¥åæ—¥æœŸ</th>
                        </tr>
                    </thead>
                    <tbody id="signupList">
                        <!-- æŠ¥åè®°å½•ç”±è„šæœ¬å¡«å…… -->
                    </tbody>
                </table>
            </div>

            <div class="member-actions" style="margin-top:20px;">
                <a class="btn" href="events.html">å»æŠ¥åæ›´å¤šæ´»åŠ¨</a>
                <a class="btn" href="games.html">è¿›å…¥ä¼šå‘˜å°æ¸¸æˆ</a>
                <a class="btn" href="chat.html">è¿›å…¥ä¼šå‘˜å¤§å®¶æ—èŠå¤©</a>
            </div>

            <!-- å¿«é€Ÿææ¬¾åŒºåŸŸ -->
            <div class="member-section">
                <h3>ğŸ’ å¿«é€Ÿææ¬¾</h3>
                <div class="quick-donation">
                    <div class="wallet-payment-info">
                        <p>ğŸ’° å½“å‰é’±åŒ…ä½™é¢: <strong id="walletBalanceForDonation">Â¥0.00</strong></p>
                    </div>
                    <div class="donation-amounts">
                        <button class="amount-btn" onclick="selectDonationAmount(10, this)">Â¥10</button>
                        <button class="amount-btn" onclick="selectDonationAmount(50, this)">Â¥50</button>
                        <button class="amount-btn" onclick="selectDonationAmount(100, this)">Â¥100</button>
                        <button class="amount-btn" onclick="selectDonationAmount(200, this)">Â¥200</button>
                        <button class="amount-btn" onclick="selectDonationAmount(500, this)">Â¥500</button>
                    </div>
                    <div class="form-group">
                        <label for="customDonationAmount">è‡ªå®šä¹‰é‡‘é¢</label>
                        <input type="number" id="customDonationAmount" min="1" max="10000" placeholder="è¾“å…¥è‡ªå®šä¹‰é‡‘é¢">
                    </div>
                    <div class="form-group">
                        <label for="donationMessage">ææ¬¾ç•™è¨€ï¼ˆå¯é€‰ï¼‰</label>
                        <textarea id="donationMessage" rows="3" placeholder="ç•™ä¸‹æ‚¨çš„ç¥ç¦æˆ–å»ºè®®"></textarea>
                    </div>
                    <button class="btn btn-primary" onclick="donateWithWallet()">ğŸ’ ä½¿ç”¨é’±åŒ…ä½™é¢ææ¬¾</button>
                </div>
            </div>

            <!-- æ´»åŠ¨æŠ¥ååŒºåŸŸ -->
            <div class="member-section">
                <h3>ğŸ¯ å³å°†ä¸¾è¡Œçš„æ´»åŠ¨</h3>
                <div class="upcoming-events">
                    <div class="event-card">
                        <h4>ğŸ¸ ç¾½æ¯›çƒå‹è°Šèµ›</h4>
                        <p>ğŸ“… æ—¶é—´: 2024å¹´12æœˆ15æ—¥ 14:00-17:00</p>
                        <p>ğŸ“ åœ°ç‚¹: ä¹æ´ç¯®çƒåœºä¸­å¿ƒ</p>
                        <p>ğŸ’° è´¹ç”¨: ä¼šå‘˜Â¥30 / éä¼šå‘˜Â¥50</p>
                        <button class="btn btn-primary" onclick="registerEventWithWallet('badminton', 30, 'ç¾½æ¯›çƒå‹è°Šèµ›')">ğŸ¯ ä½¿ç”¨é’±åŒ…æŠ¥å</button>
                    </div>
                    <div class="event-card">
                        <h4>ğŸ² ç¾é£Ÿåˆ†äº«ä¼š</h4>
                        <p>ğŸ“… æ—¶é—´: 2024å¹´12æœˆ20æ—¥ 18:00-21:00</p>
                        <p>ğŸ“ åœ°ç‚¹: æ¹–ç•”èŠ±å›­é¤å…</p>
                        <p>ğŸ’° è´¹ç”¨: ä¼šå‘˜Â¥80 / éä¼šå‘˜Â¥120</p>
                        <button class="btn btn-primary" onclick="registerEventWithWallet('food', 80, 'ç¾é£Ÿåˆ†äº«ä¼š')">ğŸ¯ ä½¿ç”¨é’±åŒ…æŠ¥å</button>
                    </div>
                    <div class="event-card">
                        <h4>ğŸ¤ åˆ›ä¸šç»éªŒåˆ†äº«ä¼š</h4>
                        <p>ğŸ“… æ—¶é—´: 2024å¹´12æœˆ25æ—¥ 14:30-17:30</p>
                        <p>ğŸ“ åœ°ç‚¹: åˆ›æ–°åˆ›ä¸šä¸­å¿ƒ</p>
                        <p>ğŸ’° è´¹ç”¨: ä¼šå‘˜Â¥50 / éä¼šå‘˜Â¥100</p>
                        <button class="btn btn-primary" onclick="registerEventWithWallet('startup', 50, 'åˆ›ä¸šç»éªŒåˆ†äº«ä¼š')">ğŸ¯ ä½¿ç”¨é’±åŒ…æŠ¥å</button>
                    </div>
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <a class="btn btn-secondary" href="events.html">æŸ¥çœ‹æ›´å¤šæ´»åŠ¨</a>
                </div>
            </div>
        </div>
    </section>

    <footer>
        <div class="container">
            <div class="footer-bottom">
                <p>&copy; 2024 é—²ç‹—è”åˆä¼š. ä¿ç•™æ‰€æœ‰æƒåˆ©.</p>
            </div>
        </div>
    </footer>

    <!-- ç¼–è¾‘èµ„æ–™æ¨¡æ€æ¡† -->
    <div id="editProfileModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ç¼–è¾‘ä¸ªäººèµ„æ–™</h3>
                <span class="close" onclick="closeEditProfile()">&times;</span>
            </div>
            <div class="modal-body">
                <form id="editProfileForm">
                    <div class="form-group">
                        <label for="editUsername">ç”¨æˆ·å</label>
                        <input type="text" id="editUsername" name="username" required>
                        <small style="color: #888;">ç”¨æˆ·åé•¿åº¦3-20ä¸ªå­—ç¬¦</small>
                    </div>
                    <div class="form-group">
                        <label for="editEmail">é‚®ç®±åœ°å€</label>
                        <input type="email" id="editEmail" name="email">
                    </div>
                    <div class="form-group">
                        <label for="editPhone">æ‰‹æœºå·ç </label>
                        <input type="tel" id="editPhone" name="phone">
                    </div>
                    <div class="form-group">
                        <label for="editCity">æ‰€åœ¨åŸå¸‚</label>
                        <input type="text" id="editCity" name="city">
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeEditProfile()">å–æ¶ˆ</button>
                        <button type="submit" class="btn btn-primary">ä¿å­˜ä¿®æ”¹</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- ä¿®æ”¹å¯†ç æ¨¡æ€æ¡† -->
    <div id="changePasswordModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ä¿®æ”¹å¯†ç </h3>
                <span class="close" onclick="closeChangePassword()">&times;</span>
            </div>
            <div class="modal-body">
                <form id="changePasswordForm">
                    <div class="form-group">
                        <label for="currentPassword">å½“å‰å¯†ç </label>
                        <input type="password" id="currentPassword" name="currentPassword" required>
                    </div>
                    <div class="form-group">
                        <label for="newPassword">æ–°å¯†ç </label>
                        <input type="password" id="newPassword" name="newPassword" required minlength="6">
                        <small style="color: #888;">å¯†ç é•¿åº¦è‡³å°‘6ä½</small>
                    </div>
                    <div class="form-group">
                        <label for="confirmPassword">ç¡®è®¤æ–°å¯†ç </label>
                        <input type="password" id="confirmPassword" name="confirmPassword" required>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeChangePassword()">å–æ¶ˆ</button>
                        <button type="submit" class="btn btn-primary">ä¿®æ”¹å¯†ç </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- é’±åŒ…å……å€¼æ¨¡æ€æ¡† -->
    <div id="walletDepositModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ğŸ’µ é’±åŒ…å……å€¼</h3>
                <span class="close" onclick="closeWalletDeposit()">&times;</span>
            </div>
            <div class="modal-body">
                <form id="walletDepositForm">
                    <div class="form-group">
                        <label for="depositAmount">å……å€¼é‡‘é¢ï¼ˆå…ƒï¼‰</label>
                        <input type="number" id="depositAmount" name="amount" min="1" max="10000" step="0.01" required>
                        <small style="color: #888;">æœ€ä½å……å€¼1å…ƒï¼Œæœ€é«˜10000å…ƒ</small>
                    </div>
                    <div class="form-group">
                        <label for="depositMethod">æ”¯ä»˜æ–¹å¼</label>
                        <select id="depositMethod" name="method" style="width: 100%; padding: 12px 15px; border: 1px solid #00ff88; border-radius: 8px; background: rgba(0, 0, 0, 0.3); color: #fff;">
                            <option value="wechat">å¾®ä¿¡æ”¯ä»˜</option>
                            <option value="alipay">æ”¯ä»˜å®</option>
                            <option value="bank">é“¶è¡Œå¡</option>
                        </select>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeWalletDeposit()">å–æ¶ˆ</button>
                        <button type="submit" class="btn btn-primary">ç¡®è®¤å……å€¼</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- é’±åŒ…ææ¬¾æ¨¡æ€æ¡† -->
    <div id="walletWithdrawModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ğŸ’¸ é’±åŒ…ææ¬¾</h3>
                <span class="close" onclick="closeWalletWithdraw()">&times;</span>
            </div>
            <div class="modal-body">
                <form id="walletWithdrawForm">
                    <div class="form-group">
                        <label for="withdrawAmount">ææ¬¾é‡‘é¢ï¼ˆå…ƒï¼‰</label>
                        <input type="number" id="withdrawAmount" name="amount" min="1" max="10000" step="0.01" required>
                        <small style="color: #888;">å½“å‰ä½™é¢ï¼š<span id="currentBalance" style="color: #00ff88;">0.00</span> å…ƒ</small>
                    </div>
                    <div class="form-group">
                        <label for="withdrawMethod">ææ¬¾æ–¹å¼</label>
                        <select id="withdrawMethod" name="method" style="width: 100%; padding: 12px 15px; border: 1px solid #00ff88; border-radius: 8px; background: rgba(0, 0, 0, 0.3); color: #fff;">
                            <option value="wechat">å¾®ä¿¡</option>
                            <option value="alipay">æ”¯ä»˜å®</option>
                            <option value="bank">é“¶è¡Œå¡</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="withdrawAccount">ææ¬¾è´¦æˆ·</label>
                        <input type="text" id="withdrawAccount" name="account" placeholder="è¯·è¾“å…¥æ”¶æ¬¾è´¦æˆ·ä¿¡æ¯" required>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeWalletWithdraw()">å–æ¶ˆ</button>
                        <button type="submit" class="btn btn-primary">ç¡®è®¤ææ¬¾</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- é’±åŒ…äº¤æ˜“è®°å½•æ¨¡æ€æ¡† -->
    <div id="walletTransactionsModal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3>ğŸ“‹ é’±åŒ…äº¤æ˜“è®°å½•</h3>
                <span class="close" onclick="closeWalletTransactions()">&times;</span>
            </div>
            <div class="modal-body">
                <div id="transactionsList" style="max-height: 400px; overflow-y: auto;">
                    <!-- äº¤æ˜“è®°å½•å°†åœ¨è¿™é‡ŒåŠ¨æ€åŠ è½½ -->
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeWalletTransactions()">å…³é—­</button>
                </div>
            </div>
        </div>
    </div>

    <script src="js/api-client.js"></script>
    <script src="js/script.js?v=4"></script>
    <script>
        // è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
        let currentUser = null;
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            loadCurrentUser();
            setupEditForms();
        });

        // åŠ è½½å½“å‰ç”¨æˆ·ä¿¡æ¯
        function loadCurrentUser() {
            const userData = localStorage.getItem('currentUser');
            if (userData) {
                currentUser = JSON.parse(userData);
                displayUserInfo();
                loadWalletInfo();
                loadDonationTotal();
                loadEventRegistrations();
            } else {
                // å¦‚æœæ²¡æœ‰ç™»å½•ï¼Œè·³è½¬åˆ°ç™»å½•é¡µé¢
                window.location.href = 'login.html';
            }
        }

        // åŠ è½½é’±åŒ…ä¿¡æ¯
        async function loadWalletInfo() {
            if (!currentUser) return;
            
            try {
                const response = await apiClient.getWallet(currentUser.id);
                if (response.success) {
                    const balance = response.wallet.balance.toFixed(2);
                    document.getElementById('walletBalance').textContent = balance;
                    document.getElementById('walletBalanceForDonation').textContent = `Â¥${balance}`;
                }
            } catch (error) {
                console.error('åŠ è½½é’±åŒ…ä¿¡æ¯å¤±è´¥:', error);
                document.getElementById('walletBalance').textContent = '0.00';
                document.getElementById('walletBalanceForDonation').textContent = 'Â¥0.00';
            }
        }

        // æ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯
        function displayUserInfo() {
            if (currentUser) {
                document.getElementById('memberName').textContent = currentUser.username;
                document.getElementById('memberEmail').textContent = currentUser.email || 'æœªè®¾ç½®é‚®ç®±';
                document.getElementById('memberLevel').textContent = currentUser.level || '1çº§';
                
                // å¡«å……ç¼–è¾‘è¡¨å•çš„é»˜è®¤å€¼
                document.getElementById('editUsername').value = currentUser.username;
                document.getElementById('editEmail').value = currentUser.email || '';
                document.getElementById('editPhone').value = currentUser.phone || '';
                document.getElementById('editCity').value = currentUser.city || '';
            }
        }

        // æ˜¾ç¤ºç¼–è¾‘èµ„æ–™æ¨¡æ€æ¡†
        function showEditProfile() {
            document.getElementById('editProfileModal').style.display = 'block';
        }

        // å…³é—­ç¼–è¾‘èµ„æ–™æ¨¡æ€æ¡†
        function closeEditProfile() {
            document.getElementById('editProfileModal').style.display = 'none';
        }

        // æ˜¾ç¤ºä¿®æ”¹å¯†ç æ¨¡æ€æ¡†
        function showChangePassword() {
            document.getElementById('changePasswordModal').style.display = 'block';
            // æ¸…ç©ºå¯†ç å­—æ®µ
            document.getElementById('currentPassword').value = '';
            document.getElementById('newPassword').value = '';
            document.getElementById('confirmPassword').value = '';
        }

        // å…³é—­ä¿®æ”¹å¯†ç æ¨¡æ€æ¡†
        function closeChangePassword() {
            document.getElementById('changePasswordModal').style.display = 'none';
        }

        // æ˜¾ç¤ºé’±åŒ…å……å€¼æ¨¡æ€æ¡†
        function showWalletDeposit() {
            document.getElementById('walletDepositModal').style.display = 'block';
            document.getElementById('depositAmount').value = '';
        }

        // å…³é—­é’±åŒ…å……å€¼æ¨¡æ€æ¡†
        function closeWalletDeposit() {
            document.getElementById('walletDepositModal').style.display = 'none';
        }

        // æ˜¾ç¤ºé’±åŒ…ææ¬¾æ¨¡æ€æ¡†
        function showWalletWithdraw() {
            document.getElementById('walletWithdrawModal').style.display = 'block';
            document.getElementById('withdrawAmount').value = '';
            document.getElementById('withdrawAccount').value = '';
            // æ›´æ–°å½“å‰ä½™é¢æ˜¾ç¤º
            const currentBalance = parseFloat(document.getElementById('walletBalance').textContent);
            document.getElementById('currentBalance').textContent = currentBalance.toFixed(2);
        }

        // å…³é—­é’±åŒ…ææ¬¾æ¨¡æ€æ¡†
        function closeWalletWithdraw() {
            document.getElementById('walletWithdrawModal').style.display = 'none';
        }

        // æ˜¾ç¤ºé’±åŒ…äº¤æ˜“è®°å½•æ¨¡æ€æ¡†
        async function showWalletTransactions() {
            document.getElementById('walletTransactionsModal').style.display = 'block';
            await loadWalletTransactions();
        }

        // å…³é—­é’±åŒ…äº¤æ˜“è®°å½•æ¨¡æ€æ¡†
        function closeWalletTransactions() {
            document.getElementById('walletTransactionsModal').style.display = 'none';
        }

        // å¤„ç†é’±åŒ…å……å€¼
        async function processWalletDeposit() {
            if (!currentUser) return;

            const amount = parseFloat(document.getElementById('depositAmount').value);
            const method = document.getElementById('depositMethod').value;

            if (!amount || amount <= 0 || amount > 10000) {
                showNotification('âŒ è¯·è¾“å…¥æœ‰æ•ˆçš„å……å€¼é‡‘é¢ï¼ˆ1-10000å…ƒï¼‰', 'error');
                return;
            }

            try {
                const response = await apiClient.depositToWallet(currentUser.id, amount);
                if (response.success) {
                    showNotification(`âœ… å……å€¼æˆåŠŸï¼Â¥${amount.toFixed(2)}å·²åˆ°è´¦`, 'success');
                    await loadWalletInfo(); // åˆ·æ–°é’±åŒ…ä½™é¢
                    closeWalletDeposit();
                } else {
                    showNotification(`âŒ å……å€¼å¤±è´¥: ${response.message}`, 'error');
                }
            } catch (error) {
                console.error('é’±åŒ…å……å€¼å¤±è´¥:', error);
                showNotification('âŒ å……å€¼å¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
            }
        }

        // å¤„ç†é’±åŒ…ææ¬¾
        async function processWalletWithdraw() {
            if (!currentUser) return;

            const amount = parseFloat(document.getElementById('withdrawAmount').value);
            const method = document.getElementById('withdrawMethod').value;
            const account = document.getElementById('withdrawAccount').value.trim();

            if (!amount || amount <= 0) {
                showNotification('âŒ è¯·è¾“å…¥æœ‰æ•ˆçš„ææ¬¾é‡‘é¢', 'error');
                return;
            }

            if (!account) {
                showNotification('âŒ è¯·è¾“å…¥æ”¶æ¬¾è´¦æˆ·ä¿¡æ¯', 'error');
                return;
            }

            const currentBalance = parseFloat(document.getElementById('walletBalance').textContent);
            if (amount > currentBalance) {
                showNotification('âŒ ä½™é¢ä¸è¶³', 'error');
                return;
            }

            try {
                const response = await apiClient.withdrawFromWallet(currentUser.id, amount);
                if (response.success) {
                    showNotification(`âœ… ææ¬¾æˆåŠŸï¼Â¥${amount.toFixed(2)}å·²æäº¤`, 'success');
                    await loadWalletInfo(); // åˆ·æ–°é’±åŒ…ä½™é¢
                    closeWalletWithdraw();
                } else {
                    showNotification(`âŒ ææ¬¾å¤±è´¥: ${response.message}`, 'error');
                }
            } catch (error) {
                console.error('é’±åŒ…ææ¬¾å¤±è´¥:', error);
                showNotification('âŒ ææ¬¾å¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
            }
        }

        // åŠ è½½é’±åŒ…äº¤æ˜“è®°å½•
        async function loadWalletTransactions() {
            if (!currentUser) return;

            try {
                const response = await apiClient.getWalletTransactions(currentUser.id, 20);
                const transactionsList = document.getElementById('transactionsList');
                
                if (response.success && response.transactions.length > 0) {
                    let html = '<table style="width: 100%; border-collapse: collapse;">';
                    html += '<thead><tr style="background: rgba(0, 255, 136, 0.1);">';
                    html += '<th style="padding: 10px; border: 1px solid #00ff88;">æ—¶é—´</th>';
                    html += '<th style="padding: 10px; border: 1px solid #00ff88;">ç±»å‹</th>';
                    html += '<th style="padding: 10px; border: 1px solid #00ff88;">é‡‘é¢</th>';
                    html += '<th style="padding: 10px; border: 1px solid #00ff88;">æè¿°</th>';
                    html += '</tr></thead><tbody>';

                    response.transactions.forEach(transaction => {
                        const date = new Date(transaction.created_at).toLocaleString('zh-CN');
                        const typeText = transaction.type === 'deposit' ? 'ğŸ’µ å……å€¼' : 
                                       transaction.type === 'withdraw' ? 'ğŸ’¸ ææ¬¾' : 'ğŸ”„ å…¶ä»–';
                        const amountColor = transaction.type === 'deposit' ? '#00ff88' : '#ff6b6b';
                        const sign = transaction.type === 'deposit' ? '+' : '-';
                        
                        html += '<tr>';
                        html += `<td style="padding: 8px; border: 1px solid #333;">${date}</td>`;
                        html += `<td style="padding: 8px; border: 1px solid #333;">${typeText}</td>`;
                        html += `<td style="padding: 8px; border: 1px solid #333; color: ${amountColor};">${sign}Â¥${Math.abs(transaction.amount).toFixed(2)}</td>`;
                        html += `<td style="padding: 8px; border: 1px solid #333;">${transaction.description || '-'}</td>`;
                        html += '</tr>';
                    });

                    html += '</tbody></table>';
                    transactionsList.innerHTML = html;
                } else {
                    transactionsList.innerHTML = '<p style="text-align: center; color: #888;">æš‚æ— äº¤æ˜“è®°å½•</p>';
                }
            } catch (error) {
                console.error('åŠ è½½äº¤æ˜“è®°å½•å¤±è´¥:', error);
                document.getElementById('transactionsList').innerHTML = '<p style="text-align: center; color: #ff6b6b;">åŠ è½½äº¤æ˜“è®°å½•å¤±è´¥</p>';
            }
        }

        // è®¾ç½®è¡¨å•æäº¤å¤„ç†
        function setupEditForms() {
            // ç¼–è¾‘èµ„æ–™è¡¨å•
            document.getElementById('editProfileForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                await updateProfile();
            });

            // ä¿®æ”¹å¯†ç è¡¨å•
            document.getElementById('changePasswordForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                await changePassword();
            });

            // é’±åŒ…å……å€¼è¡¨å•
            document.getElementById('walletDepositForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                await processWalletDeposit();
            });

            // é’±åŒ…ææ¬¾è¡¨å•
            document.getElementById('walletWithdrawForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                await processWalletWithdraw();
            });

            // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
            window.addEventListener('click', function(event) {
                const editModal = document.getElementById('editProfileModal');
                const passwordModal = document.getElementById('changePasswordModal');
                const depositModal = document.getElementById('walletDepositModal');
                const withdrawModal = document.getElementById('walletWithdrawModal');
                const transactionsModal = document.getElementById('walletTransactionsModal');
                
                if (event.target === editModal) {
                    closeEditProfile();
                }
                if (event.target === passwordModal) {
                    closeChangePassword();
                }
                if (event.target === depositModal) {
                    closeWalletDeposit();
                }
                if (event.target === withdrawModal) {
                    closeWalletWithdraw();
                }
                if (event.target === transactionsModal) {
                    closeWalletTransactions();
                }
            });
        }

        // æ›´æ–°ä¸ªäººèµ„æ–™
        async function updateProfile() {
            if (!currentUser) return;

            const updates = {
                username: document.getElementById('editUsername').value.trim(),
                email: document.getElementById('editEmail').value.trim(),
                phone: document.getElementById('editPhone').value.trim(),
                city: document.getElementById('editCity').value.trim()
            };

            // éªŒè¯ç”¨æˆ·å
            if (updates.username.length < 3 || updates.username.length > 20) {
                showNotification('âŒ ç”¨æˆ·åé•¿åº¦å¿…é¡»åœ¨3-20ä¸ªå­—ç¬¦ä¹‹é—´', 'error');
                return;
            }

            try {
                const response = await apiClient.updateMember(currentUser.id, updates);
                if (response.success) {
                    // æ›´æ–°æœ¬åœ°å­˜å‚¨çš„ç”¨æˆ·ä¿¡æ¯
                    currentUser = { ...currentUser, ...updates };
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));
                    
                    // æ›´æ–°é¡µé¢æ˜¾ç¤º
                    displayUserInfo();
                    
                    showNotification('âœ… ä¸ªäººèµ„æ–™æ›´æ–°æˆåŠŸï¼', 'success');
                    closeEditProfile();
                } else {
                    showNotification(`âŒ æ›´æ–°å¤±è´¥: ${response.message}`, 'error');
                }
            } catch (error) {
                console.error('æ›´æ–°ä¸ªäººèµ„æ–™å¤±è´¥:', error);
                showNotification('âŒ æ›´æ–°ä¸ªäººèµ„æ–™å¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
            }
        }

        // ä¿®æ”¹å¯†ç 
        async function changePassword() {
            if (!currentUser) return;

            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;

            // éªŒè¯è¾“å…¥
            if (newPassword.length < 6) {
                showNotification('âŒ æ–°å¯†ç é•¿åº¦è‡³å°‘6ä½', 'error');
                return;
            }

            if (newPassword !== confirmPassword) {
                showNotification('âŒ æ–°å¯†ç ä¸ç¡®è®¤å¯†ç ä¸ä¸€è‡´', 'error');
                return;
            }

            try {
                const response = await apiClient.changePassword(currentUser.id, currentPassword, newPassword);
                if (response.success) {
                    // æ›´æ–°æœ¬åœ°å­˜å‚¨çš„å¯†ç 
                    currentUser.password = newPassword;
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));
                    
                    showNotification('âœ… å¯†ç ä¿®æ”¹æˆåŠŸï¼è¯·ç‰¢è®°æ–°å¯†ç ', 'success');
                    closeChangePassword();
                } else {
                    showNotification(`âŒ å¯†ç ä¿®æ”¹å¤±è´¥: ${response.message}`, 'error');
                }
            } catch (error) {
                console.error('ä¿®æ”¹å¯†ç å¤±è´¥:', error);
                showNotification('âŒ ä¿®æ”¹å¯†ç å¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
            }
        }

        // æ˜¾ç¤ºé€šçŸ¥æ¶ˆæ¯
        function showNotification(message, type = 'info') {
            // åˆ›å»ºé€šçŸ¥å…ƒç´ 
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 20px;
                border-radius: 8px;
                color: white;
                font-weight: bold;
                z-index: 10000;
                animation: slideIn 0.3s ease;
                max-width: 300px;
                word-wrap: break-word;
            `;

            // æ ¹æ®ç±»å‹è®¾ç½®é¢œè‰²
            switch (type) {
                case 'success':
                    notification.style.background = '#00ff88';
                    notification.style.color = '#000';
                    break;
                case 'error':
                    notification.style.background = '#ff6b6b';
                    break;
                case 'warning':
                    notification.style.background = '#ffc107';
                    notification.style.color = '#000';
                    break;
                default:
                    notification.style.background = '#00ff88';
                    notification.style.color = '#000';
            }

            notification.textContent = message;
            document.body.appendChild(notification);

            // 3ç§’åè‡ªåŠ¨ç§»é™¤
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        // é€‰æ‹©ææ¬¾é‡‘é¢
        function selectDonationAmount(amount, btn) {
            // æ¸…é™¤æ‰€æœ‰é€‰ä¸­çŠ¶æ€
            document.querySelectorAll('.donation-amounts .amount-btn').forEach(btn => {
                btn.classList.remove('selected');
                btn.style.background = '#666';
                btn.style.color = '#fff';
            });
            
            // è®¾ç½®å½“å‰é€‰ä¸­çŠ¶æ€
            if (btn) {
                btn.classList.add('selected');
                btn.style.background = '#00ff88';
                btn.style.color = '#000';
            }
            
            // è®¾ç½®è‡ªå®šä¹‰é‡‘é¢è¾“å…¥æ¡†çš„å€¼
            document.getElementById('customDonationAmount').value = amount;
        }

        // ä½¿ç”¨é’±åŒ…ä½™é¢ææ¬¾
        async function donateWithWallet() {
            if (!currentUser) {
                showNotification('âŒ è¯·å…ˆç™»å½•', 'error');
                return;
            }

            const customAmount = document.getElementById('customDonationAmount').value;
            const message = document.getElementById('donationMessage').value.trim();
            
            let amount = 0;
            if (customAmount && parseFloat(customAmount) > 0) {
                amount = parseFloat(customAmount);
            } else {
                showNotification('âŒ è¯·é€‰æ‹©æˆ–è¾“å…¥ææ¬¾é‡‘é¢', 'error');
                return;
            }

            if (amount > 10000) {
                showNotification('âŒ å•æ¬¡ææ¬¾é‡‘é¢ä¸èƒ½è¶…è¿‡10000å…ƒ', 'error');
                return;
            }

            // æ£€æŸ¥é’±åŒ…ä½™é¢
            const currentBalance = parseFloat(document.getElementById('walletBalance').textContent);
            if (amount > currentBalance) {
                showNotification('âŒ é’±åŒ…ä½™é¢ä¸è¶³ï¼Œè¯·å…ˆå……å€¼', 'error');
                return;
            }

            // ç¡®è®¤ææ¬¾
            const confirmMessage = `ç¡®è®¤ææ¬¾ Â¥${amount.toFixed(2)} å…ƒå—ï¼Ÿ\n${message ? 'ç•™è¨€ï¼š' + message : ''}`;
            if (!confirm(confirmMessage)) {
                return;
            }

            try {
                // æ‰§è¡Œé’±åŒ…æ‰£æ¬¾
                const response = await apiClient.withdrawFromWallet(currentUser.id, amount);
                if (response.success) {
                    // è®°å½•ææ¬¾ä¿¡æ¯åˆ°æ•°æ®åº“
                    const donationData = {
                        user_id: currentUser.id,
                        amount: amount,
                        message: message,
                        payment_method: 'wallet',
                        status: 'completed'
                    };

                    // è°ƒç”¨ææ¬¾APIè®°å½•ææ¬¾
                    try {
                        const donationResponse = await apiClient.request('/api/donations', {
                            method: 'POST',
                            body: JSON.stringify(donationData)
                        });
                        
                        if (donationResponse.success) {
                            showNotification(`âœ… ææ¬¾æˆåŠŸï¼æ„Ÿè°¢æ‚¨å¯¹é—²ç‹—è”åˆä¼šçš„æ”¯æŒï¼\nææ¬¾é‡‘é¢ï¼šÂ¥${amount.toFixed(2)}å…ƒ`, 'success');
                            
                            // åˆ·æ–°é’±åŒ…ä½™é¢å’Œææ¬¾æ€»é¢
                            await loadWalletInfo();
                            loadDonationTotal();
                            
                            // æ¸…ç©ºè¡¨å•
                            document.getElementById('customDonationAmount').value = '';
                            document.getElementById('donationMessage').value = '';
                            document.querySelectorAll('.donation-amounts .amount-btn').forEach(btn => {
                                btn.style.background = '#666';
                                btn.style.color = '#fff';
                            });
                        } else {
                            // å¦‚æœææ¬¾è®°å½•å¤±è´¥ï¼Œéœ€è¦å›æ»šé’±åŒ…æ‰£æ¬¾
                            await apiClient.depositToWallet(currentUser.id, amount);
                            showNotification(`âŒ ææ¬¾è®°å½•å¤±è´¥ï¼Œå·²é€€å›é’±åŒ…æ‰£æ¬¾`, 'error');
                        }
                    } catch (donationError) {
                        // å¦‚æœææ¬¾è®°å½•å¤±è´¥ï¼Œéœ€è¦å›æ»šé’±åŒ…æ‰£æ¬¾
                        await apiClient.depositToWallet(currentUser.id, amount);
                        console.error('ææ¬¾è®°å½•å¤±è´¥:', donationError);
                        showNotification(`âŒ ææ¬¾è®°å½•å¤±è´¥ï¼Œå·²é€€å›é’±åŒ…æ‰£æ¬¾`, 'error');
                    }
                } else {
                    showNotification(`âŒ ææ¬¾å¤±è´¥: ${response.message}`, 'error');
                }
            } catch (error) {
                console.error('ææ¬¾å¤±è´¥:', error);
                showNotification('âŒ ææ¬¾å¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
            }
        }

        // ä½¿ç”¨é’±åŒ…ä½™é¢æŠ¥åæ´»åŠ¨
        async function registerEventWithWallet(eventId, fee, eventName) {
            if (!currentUser) {
                showNotification('âŒ è¯·å…ˆç™»å½•', 'error');
                return;
            }

            // æ£€æŸ¥é’±åŒ…ä½™é¢
            const currentBalance = parseFloat(document.getElementById('walletBalance').textContent);
            if (fee > currentBalance) {
                showNotification('âŒ é’±åŒ…ä½™é¢ä¸è¶³ï¼Œè¯·å…ˆå……å€¼', 'error');
                return;
            }

            // ç¡®è®¤æŠ¥å
            const confirmMessage = `ç¡®è®¤æŠ¥åå‚åŠ æ´»åŠ¨ã€Œ${eventName}ã€å—ï¼Ÿ\næ´»åŠ¨è´¹ç”¨ï¼šÂ¥${fee.toFixed(2)}å…ƒ`;
            if (!confirm(confirmMessage)) {
                return;
            }

            try {
                // æ‰§è¡Œé’±åŒ…æ‰£æ¬¾
                const response = await apiClient.withdrawFromWallet(currentUser.id, fee);
                if (response.success) {
                    // è®°å½•æ´»åŠ¨æŠ¥åï¼ˆè¿™é‡Œç®€åŒ–å¤„ç†ï¼Œå®é™…åº”è¯¥è°ƒç”¨æ´»åŠ¨æŠ¥åAPIï¼‰
                    const registrationData = {
                        user_id: currentUser.id,
                        event_id: eventId,
                        event_name: eventName,
                        fee: fee,
                        payment_method: 'wallet',
                        status: 'confirmed'
                    };

                    // æ¨¡æ‹Ÿæ´»åŠ¨æŠ¥åè®°å½•
                    showNotification(`âœ… æ´»åŠ¨æŠ¥åæˆåŠŸï¼\næ´»åŠ¨ï¼š${eventName}\nè´¹ç”¨ï¼šÂ¥${fee.toFixed(2)}å…ƒ`, 'success');
                    
                    // åˆ·æ–°é’±åŒ…ä½™é¢
                    await loadWalletInfo();
                    
                    // åˆ·æ–°æ´»åŠ¨æŠ¥ååˆ—è¡¨
                    loadEventRegistrations();
                } else {
                    showNotification(`âŒ æ´»åŠ¨æŠ¥åå¤±è´¥: ${response.message}`, 'error');
                }
            } catch (error) {
                console.error('æ´»åŠ¨æŠ¥åå¤±è´¥:', error);
                showNotification('âŒ æ´»åŠ¨æŠ¥åå¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
            }
        }

        // åŠ è½½ææ¬¾æ€»é¢
        async function loadDonationTotal() {
            if (!currentUser) return;
            
            try {
                const response = await apiClient.getUserDonations(currentUser.id);
                if (response.success) {
                    document.getElementById('donationTotal').textContent = response.total_amount.toFixed(2);
                } else {
                    document.getElementById('donationTotal').textContent = '0.00';
                }
            } catch (error) {
                console.error('åŠ è½½ææ¬¾æ€»é¢å¤±è´¥:', error);
                document.getElementById('donationTotal').textContent = '0.00';
            }
        }

        // åŠ è½½æ´»åŠ¨æŠ¥åè®°å½•
        async function loadEventRegistrations() {
            if (!currentUser) return;
            
            try {
                // è¿™é‡Œåº”è¯¥è°ƒç”¨è·å–ç”¨æˆ·æ´»åŠ¨æŠ¥åè®°å½•çš„API
                // æš‚æ—¶æ˜¾ç¤ºæ¨¡æ‹Ÿæ•°æ®
                const mockRegistrations = [
                    {
                        event_name: 'ç¾½æ¯›çƒå‹è°Šèµ›',
                        location: 'ä¹æ´ç¯®çƒåœºä¸­å¿ƒ',
                        event_time: '2024å¹´12æœˆ15æ—¥ 14:00-17:00',
                        registration_date: '2024-12-10'
                    },
                    {
                        event_name: 'ç¾é£Ÿåˆ†äº«ä¼š',
                        location: 'æ¹–ç•”èŠ±å›­é¤å…',
                        event_time: '2024å¹´12æœˆ20æ—¥ 18:00-21:00',
                        registration_date: '2024-12-12'
                    }
                ];

                const signupList = document.getElementById('signupList');
                signupList.innerHTML = '';
                
                mockRegistrations.forEach(registration => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${registration.event_name}</td>
                        <td>${registration.location}</td>
                        <td>${registration.event_time}</td>
                        <td>${registration.registration_date}</td>
                    `;
                    signupList.appendChild(row);
                });
            } catch (error) {
                console.error('åŠ è½½æ´»åŠ¨æŠ¥åè®°å½•å¤±è´¥:', error);
                document.getElementById('signupList').innerHTML = '<tr><td colspan="4" style="text-align: center; color: #888;">æš‚æ— æŠ¥åè®°å½•</td></tr>';
            }
        }

        // æ·»åŠ åŠ¨ç”»æ ·å¼
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>